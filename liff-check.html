<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>LIFF Check</title>
  <style>body{font:16px/1.5 system-ui,Segoe UI,Arial;margin:1rem;} button{padding:.5rem .75rem;border-radius:8px;border:1px solid #ddd;background:#111;color:#fff} pre{white-space:pre-wrap;word-break:break-word;background:#f3f4f6;padding:8px;border-radius:8px}</style>
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
</head>
<body>
  <h1>LIFF Check</h1>
  <div id="status">Initializing…</div>
  <div style="margin:.75rem 0;">
    <button id="loginBtn">Login with LINE</button>
    <button id="logoutBtn">Logout</button>
  </div>
  <pre id="out"></pre>
  <script>
    (async function(){
      const out = document.getElementById('out');
      const status = document.getElementById('status');
      function log(obj){ try{ out.textContent = (typeof obj==='string'?obj:JSON.stringify(obj,null,2)); }catch(e){ out.textContent = String(obj); } }
      const liffId = "2008228481-xBBwXqp1";
      const origin = location.origin;
      try {
        await liff.init({ liffId });
        status.textContent = 'LIFF init: OK on ' + origin;
        if (liff.isLoggedIn()) {
          const profile = await liff.getProfile().catch(()=>null);
          log({ isLoggedIn:true, userId: profile && profile.userId, displayName: profile && profile.displayName, context: liff.getContext && liff.getContext() });
        } else {
          log({ isLoggedIn:false, hint:'Tap Login to proceed' });
        }
      } catch (e) {
        status.textContent = 'LIFF init: FAILED on ' + origin;
        log({ error: String(e && e.message || e), origin, liffId });
      }
      document.getElementById('loginBtn').onclick = function(){
        try { liff.login({ redirectUri: origin + '/?from=liff-check' }); } catch(e){ log('login error: '+e); }
      };
      document.getElementById('logoutBtn').onclick = function(){ try { liff.logout(); location.reload(); } catch(e){ log('logout error: '+e); } };
    })();
  </script>
</body>
</html>