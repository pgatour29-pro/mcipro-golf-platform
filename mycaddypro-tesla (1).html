<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MyCaddyPro - Premium Golf Management</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@300;400;500;600;700" rel="stylesheet">
    
    <!-- LINE LIFF SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <style>
        /* ===== TESLA DESIGN SYSTEM ===== */
        :root {
            /* Colors - Tesla Inspired */
            --tesla-bg: #000000;
            --tesla-surface: #1a1a1a;
            --tesla-surface-elevated: #222222;
            --tesla-border: rgba(255,255,255,0.08);
            --tesla-divider: rgba(255,255,255,0.06);
            
            --tesla-primary: #3E6AE1;
            --tesla-primary-hover: #5580FF;
            --tesla-primary-active: #2952C8;
            
            --tesla-text-primary: #FFFFFF;
            --tesla-text-secondary: rgba(255,255,255,0.7);
            --tesla-text-tertiary: rgba(255,255,255,0.5);
            --tesla-text-disabled: rgba(255,255,255,0.3);
            
            --tesla-success: #00D563;
            --tesla-warning: #FFB800;
            --tesla-error: #FF4444;
            
            /* Glass morphism */
            --glass-bg: rgba(255,255,255,0.03);
            --glass-border: rgba(255,255,255,0.1);
            --glass-shadow: 0 8px 32px 0 rgba(0,0,0,0.4);
            
            /* Spacing */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            
            /* Border radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Typography */
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        /* ===== GLOBAL RESET ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-family: var(--font-family);
            background: var(--tesla-bg);
            color: var(--tesla-text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* ===== GLASS WHITEBOARD BASE ===== */
        .gw-bg {
            position: fixed;
            inset: 0;
            z-index: -30;
            background: var(--tesla-bg);
        }
        
        .gw-bg::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at 30% 20%, rgba(62,106,225,0.15), transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(0,213,99,0.1), transparent 50%),
                        linear-gradient(135deg, #0a0e15 0%, #1a1a1a 100%);
            opacity: 0.6;
        }
        
        .gw-bg::after {
            content: "";
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(1200px 800px at 50% -10%, rgba(62,106,225,0.12), transparent 70%),
                radial-gradient(1200px 700px at 50% 120%, rgba(0,0,0,0.5), transparent 70%);
        }
        
        .gw-noise {
            position: fixed;
            inset: 0;
            z-index: -20;
            pointer-events: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.03"/></svg>');
            background-size: 160px 160px;
            mix-blend-mode: overlay;
        }
        
        .gw-frame {
            position: fixed;
            inset: 0;
            z-index: -10;
            pointer-events: none;
        }
        
        .gw-frame::before {
            content: "";
            position: fixed;
            inset: 16px;
            border-radius: 28px;
            border: 1px solid var(--glass-border);
            box-shadow: 
                0 0 0 1px rgba(255,255,255,0.05) inset,
                0 30px 60px rgba(0,0,0,0.3) inset;
        }
        
        .gw-sheen {
            position: fixed;
            inset: 0;
            z-index: -5;
            pointer-events: none;
            opacity: 0.15;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0.08),
                transparent 40%,
                rgba(255,255,255,0.04)
            );
            mix-blend-mode: screen;
        }
        
        /* ===== MAIN APP CONTAINER ===== */
        #app {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            padding: 0;
            max-width: 100vw;
            overflow-x: hidden;
        }
        
        /* ===== SCREEN SYSTEM ===== */
        .screen {
            display: none;
            min-height: 100vh;
            opacity: 0;
            transition: opacity var(--transition-base);
        }
        
        .screen.active {
            display: flex;
            flex-direction: column;
            opacity: 1;
        }
        
        /* ===== TESLA COMPONENTS ===== */
        
        /* Glass Card */
        .tesla-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: var(--spacing-xl);
            transition: all var(--transition-base);
        }
        
        .tesla-card:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateY(-2px);
            box-shadow: var(--glass-shadow);
        }
        
        @media (max-width: 768px) {
            .tesla-card {
                padding: var(--spacing-lg);
            }
        }
        
        /* Buttons */
        .tesla-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: 12px 24px;
            border-radius: var(--radius-full);
            font-weight: 500;
            font-size: 15px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
            min-height: 48px;
        }
        
        .tesla-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255,255,255,0.1);
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        
        .tesla-btn:hover::before {
            opacity: 1;
        }
        
        .tesla-btn:active {
            transform: scale(0.98);
        }
        
        .tesla-btn-primary {
            background: var(--tesla-primary);
            color: white;
        }
        
        .tesla-btn-primary:hover {
            background: var(--tesla-primary-hover);
        }
        
        .tesla-btn-secondary {
            background: var(--tesla-surface-elevated);
            color: var(--tesla-text-primary);
            border: 1px solid var(--tesla-border);
        }
        
        .tesla-btn-ghost {
            background: transparent;
            color: var(--tesla-text-secondary);
            border: 1px solid var(--tesla-border);
        }
        
        /* Inputs */
        .tesla-input {
            width: 100%;
            padding: 14px 16px;
            background: var(--tesla-surface);
            border: 1px solid var(--tesla-border);
            border-radius: var(--radius-md);
            color: var(--tesla-text-primary);
            font-size: 15px;
            font-family: var(--font-family);
            transition: all var(--transition-base);
        }
        
        .tesla-input:focus {
            outline: none;
            border-color: var(--tesla-primary);
            background: var(--tesla-surface-elevated);
        }
        
        .tesla-input::placeholder {
            color: var(--tesla-text-tertiary);
        }
        
        /* Header */
        .tesla-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--tesla-border);
            padding: var(--spacing-md) var(--spacing-lg);
        }
        
        .tesla-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Navigation */
        .tesla-nav {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background: var(--tesla-surface);
            border-radius: var(--radius-lg);
        }
        
        .tesla-nav-item {
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--tesla-text-secondary);
            text-decoration: none;
            border-radius: var(--radius-sm);
            transition: all var(--transition-base);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .tesla-nav-item:hover {
            color: var(--tesla-text-primary);
            background: var(--tesla-surface-elevated);
        }
        
        .tesla-nav-item.active {
            color: var(--tesla-primary);
            background: rgba(62,106,225,0.15);
        }
        
        /* Bottom Navigation */
        .tesla-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid var(--tesla-border);
            padding: var(--spacing-sm) var(--spacing-md);
            padding-bottom: calc(var(--spacing-sm) + env(safe-area-inset-bottom));
        }
        
        .tesla-bottom-nav-content {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .tesla-bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: var(--spacing-sm);
            color: var(--tesla-text-tertiary);
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
        }
        
        .tesla-bottom-nav-item.active {
            color: var(--tesla-primary);
        }
        
        .tesla-bottom-nav-item span.material-symbols-outlined {
            font-size: 24px;
        }
        
        .tesla-bottom-nav-item span:not(.material-symbols-outlined) {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Badge */
        .tesla-badge {
            position: absolute;
            top: 0;
            right: 0;
            min-width: 18px;
            height: 18px;
            padding: 0 4px;
            background: var(--tesla-error);
            color: white;
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Stats Grid */
        .tesla-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .tesla-stat-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            text-align: center;
        }
        
        .tesla-stat-value {
            font-size: 40px;
            font-weight: 600;
            color: var(--tesla-primary);
            line-height: 1.2;
            letter-spacing: -0.03em;
        }
        
        .tesla-stat-label {
            font-size: 14px;
            color: var(--tesla-text-secondary);
            margin-top: var(--spacing-sm);
        }
        
        @media (max-width: 768px) {
            .tesla-stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-md);
            }
        }
        
        /* Content Container */
        .tesla-content {
            flex: 1;
            padding: var(--spacing-xl);
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            padding-bottom: 120px;
        }
        
        @media (max-width: 768px) {
            .tesla-content {
                padding: var(--spacing-lg) var(--spacing-md);
                padding-bottom: 100px;
            }
        }
        
        /* Section */
        .tesla-section {
            margin-bottom: var(--spacing-2xl);
        }
        
        .tesla-section-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--spacing-lg);
            color: var(--tesla-text-primary);
            letter-spacing: -0.02em;
        }
        
        /* List */
        .tesla-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }
        
        .tesla-list-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            transition: all var(--transition-base);
            cursor: pointer;
        }
        
        .tesla-list-item:hover {
            background: rgba(255,255,255,0.05);
            transform: translateX(4px);
        }
        
        @media (max-width: 768px) {
            .tesla-list {
                gap: var(--spacing-md);
            }
            
            .tesla-list-item {
                padding: var(--spacing-lg);
            }
        }
        
        /* Progress Bar */
        .tesla-progress {
            width: 100%;
            height: 4px;
            background: var(--tesla-surface);
            border-radius: var(--radius-full);
            overflow: hidden;
        }
        
        .tesla-progress-bar {
            height: 100%;
            background: var(--tesla-primary);
            transition: width var(--transition-slow);
            border-radius: var(--radius-full);
        }
        
        /* Modal */
        .tesla-modal {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
        }
        
        .tesla-modal.active {
            display: flex;
        }
        
        .tesla-modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .tesla-modal-content {
            position: relative;
            background: var(--tesla-surface);
            border: 1px solid var(--tesla-border);
            border-radius: var(--radius-xl);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .tesla-modal-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--tesla-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .tesla-modal-body {
            padding: var(--spacing-lg);
        }
        
        .tesla-modal-footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--tesla-border);
            display: flex;
            gap: var(--spacing-sm);
            justify-content: flex-end;
        }
        
        /* Toast */
        .tesla-toast {
            position: fixed;
            top: var(--spacing-lg);
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            z-index: 2000;
            background: var(--tesla-surface-elevated);
            border: 1px solid var(--tesla-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md) var(--spacing-lg);
            min-width: 300px;
            max-width: 500px;
            box-shadow: var(--glass-shadow);
            opacity: 0;
            transition: all var(--transition-base);
        }
        
        .tesla-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* Icon Button */
        .tesla-icon-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-full);
            background: transparent;
            border: 1px solid var(--tesla-border);
            color: var(--tesla-text-secondary);
            cursor: pointer;
            transition: all var(--transition-base);
        }
        
        .tesla-icon-btn:hover {
            background: var(--tesla-surface);
            color: var(--tesla-text-primary);
        }
        
        /* Grid */
        .tesla-grid {
            display: grid;
            gap: var(--spacing-lg);
        }
        
        .tesla-grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .tesla-grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        @media (max-width: 768px) {
            .tesla-grid {
                gap: var(--spacing-md);
            }
            
            .tesla-grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .tesla-grid-2 {
                grid-template-columns: 1fr;
            }
        }
        
        /* Utilities */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-sm { gap: var(--spacing-sm); }
        .gap-md { gap: var(--spacing-md); }
        .gap-lg { gap: var(--spacing-lg); }
        .text-center { text-align: center; }
        .text-secondary { color: var(--tesla-text-secondary); }
        .text-tertiary { color: var(--tesla-text-tertiary); }
        .text-sm { font-size: 13px; }
        .text-lg { font-size: 18px; }
        .font-semibold { font-weight: 600; }
        .mb-sm { margin-bottom: var(--spacing-sm); }
        .mb-md { margin-bottom: var(--spacing-md); }
        .mb-lg { margin-bottom: var(--spacing-lg); }
        .mb-xl { margin-bottom: var(--spacing-xl); }
        .mt-md { margin-top: var(--spacing-md); }
        .mt-lg { margin-top: var(--spacing-lg); }
        .p-0 { padding: 0; }
        .py-xl { padding-top: var(--spacing-xl); padding-bottom: var(--spacing-xl); }
        
        /* Login Screen Specific */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: var(--spacing-xl);
        }
        
        .login-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: var(--spacing-2xl);
            width: 100%;
            max-width: 420px;
            box-shadow: var(--glass-shadow);
        }
        
        .login-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-lg);
            background: rgba(62,106,225,0.15);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .login-logo .material-symbols-outlined {
            font-size: 48px;
            color: var(--tesla-primary);
        }
        
        .login-title {
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            margin-bottom: var(--spacing-sm);
        }
        
        .login-subtitle {
            font-size: 15px;
            color: var(--tesla-text-secondary);
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }
        
        /* Form */
        .tesla-form-group {
            margin-bottom: var(--spacing-md);
        }
        
        .tesla-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: var(--spacing-xs);
            color: var(--tesla-text-secondary);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn var(--transition-base) ease-out;
        }
        
        .animate-slide-up {
            animation: slideUp var(--transition-base) ease-out;
        }
    </style>
</head>
<body>
    <!-- Glass Whiteboard Layers -->
    <div class="gw-bg"></div>
    <div class="gw-noise"></div>
    <div class="gw-frame"></div>
    <div class="gw-sheen"></div>
    
    <!-- Main App Container -->
    <div id="app">
        <!-- LOGIN SCREEN -->
        <div id="loginScreen" class="screen active">
            <div class="login-container">
                <div class="login-card animate-fade-in">
                    <div class="login-logo">
                        <span class="material-symbols-outlined">golf_course</span>
                    </div>
                    <h1 class="login-title" data-i18n="app_title">MyCaddyPro</h1>
                    <p class="login-subtitle" data-i18n="app_subtitle">Premium Golf Course Management</p>
                    
                    <div class="tesla-form-group">
                        <label class="tesla-label" data-i18n="language">Language</label>
                        <select id="languageSelect" class="tesla-input" onchange="switchLanguage(this.value)">
                            <option value="en">English</option>
                            <option value="th">ไทย</option>
                            <option value="ko">한국어</option>
                            <option value="ja">日本語</option>
                        </select>
                    </div>
                    
                    <!-- LINE Login Button -->
                    <button class="tesla-btn" style="width: 100%; background: #00B900; color: white; margin-bottom: var(--spacing-md);" onclick="loginWithLine()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                            <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/>
                        </svg>
                        <span>Login with LINE</span>
                    </button>
                    
                    <div style="text-align: center; color: var(--tesla-text-tertiary); margin: var(--spacing-md) 0; font-size: 14px;">
                        OR
                    </div>
                    
                    <div class="tesla-form-group">
                        <label class="tesla-label">Phone Number</label>
                        <input type="tel" id="phoneNumber" class="tesla-input" placeholder="+66 XX XXX XXXX" maxlength="15">
                    </div>
                    
                    <div class="flex items-center justify-between mb-lg">
                        <label class="flex items-center gap-sm text-sm" style="cursor: pointer;">
                            <input type="checkbox" id="rememberMe" style="width: 18px; height: 18px;">
                            <span class="text-secondary" data-i18n="remember_me">Remember me</span>
                        </label>
                        <a href="#" class="text-sm" style="color: var(--tesla-primary); text-decoration: none;" onclick="showForgotPassword(); return false;" data-i18n="forgot_password">Forgot password?</a>
                    </div>
                    
                    <div class="flex flex-col gap-sm">
                        <button class="tesla-btn tesla-btn-primary" onclick="requestOtp()">
                            <span class="material-symbols-outlined">phone</span>
                            <span>Send OTP</span>
                        </button>
                        <button class="tesla-btn tesla-btn-secondary" onclick="showRoleSelection()">
                            <span class="material-symbols-outlined">badge</span>
                            <span>Staff Login</span>
                        </button>
                        <button class="tesla-btn tesla-btn-ghost" onclick="login('guest')">
                            <span data-i18n="continue_as_guest">Continue as Guest</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- OTP VERIFICATION SCREEN -->
        <div id="otpScreen" class="screen">
            <div class="login-container">
                <div class="login-card animate-fade-in">
                    <button class="tesla-icon-btn" style="position: absolute; top: 20px; left: 20px;" onclick="backToLogin()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    
                    <div class="login-logo">
                        <span class="material-symbols-outlined">lock</span>
                    </div>
                    <h1 class="login-title">Verify OTP</h1>
                    <p class="login-subtitle">Enter the 6-digit code sent to<br><strong id="otpPhoneDisplay"></strong></p>
                    
                    <div class="tesla-form-group">
                        <label class="tesla-label">OTP Code</label>
                        <input type="text" id="otpInput" class="tesla-input" placeholder="000000" maxlength="6" style="text-align: center; font-size: 24px; letter-spacing: 8px; font-weight: 600;" oninput="handleOtpInput(this)">
                        <div id="otpError" class="text-sm mt-sm" style="color: var(--tesla-error); display: none;"></div>
                    </div>
                    
                    <div class="mb-lg text-center">
                        <div class="text-sm text-secondary mb-sm">Code expires in</div>
                        <div id="otpCountdown" style="font-size: 32px; font-weight: 700; color: var(--tesla-primary);">02:00</div>
                        <div class="text-sm text-secondary mt-sm">Attempts remaining: <span id="otpAttemptsRemaining">3</span>/3</div>
                    </div>
                    
                    <div class="flex flex-col gap-sm">
                        <button class="tesla-btn tesla-btn-primary" onclick="verifyOtp()">
                            <span class="material-symbols-outlined">check_circle</span>
                            <span>Verify Code</span>
                        </button>
                        <button id="resendOtpBtn" class="tesla-btn tesla-btn-ghost" onclick="resendOtp()" disabled>
                            <span class="material-symbols-outlined">refresh</span>
                            <span>Resend Code (<span id="resendCountdown">60</span>s)</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ROLE SELECTION SCREEN -->
        <div id="roleSelectionScreen" class="screen">
            <div class="login-container">
                <div class="login-card animate-fade-in">
                    <button class="tesla-icon-btn" style="position: absolute; top: 20px; left: 20px;" onclick="backToLogin()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    
                    <div class="login-logo">
                        <span class="material-symbols-outlined">badge</span>
                    </div>
                    <h1 class="login-title">Staff Login</h1>
                    <p class="login-subtitle">Select your role to continue</p>
                    
                    <div class="flex flex-col gap-sm mt-lg">
                        <button class="tesla-btn tesla-btn-secondary" onclick="login('caddie')">
                            <span class="material-symbols-outlined">badge</span>
                            <span data-i18n="login_as_caddie">Login as Caddie</span>
                        </button>
                        <button class="tesla-btn tesla-btn-secondary" onclick="login('manager')">
                            <span class="material-symbols-outlined">admin_panel_settings</span>
                            <span data-i18n="login_as_manager">Login as Manager</span>
                        </button>
                        <button class="tesla-btn tesla-btn-secondary" onclick="login('proshop')">
                            <span class="material-symbols-outlined">store</span>
                            <span data-i18n="login_as_proshop">Login as Pro Shop</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CADDIE DASHBOARD -->
        <div id="caddieDashboard" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="logout()">
                        <span class="material-symbols-outlined">logout</span>
                    </button>
                    <h1 class="text-lg font-semibold">Caddie Dashboard</h1>
                    <select id="caddieLanguage" class="tesla-input" style="width: 80px; padding: 8px 12px; font-size: 13px;" onchange="switchLanguage(this.value)">
                        <option value="en">EN</option>
                        <option value="th">TH</option>
                        <option value="ko">KO</option>
                        <option value="ja">JA</option>
                    </select>
                </div>
                <div class="tesla-nav mt-md">
                    <div class="tesla-nav-item active" onclick="showCaddieTab('assignments')">Assignments</div>
                    <div class="tesla-nav-item" onclick="showCaddieTab('communication')">Messages</div>
                    <div class="tesla-nav-item" onclick="showCaddieTab('schedule')">Schedule</div>
                </div>
            </div>
            
            <div class="tesla-content">
                <!-- Assignments Tab -->
                <div id="caddieAssignmentsTab" class="tab-content">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Current Assignment</h3>
                        <div id="currentAssignment" class="tesla-card mb-xl">
                            <!-- Current assignment will be populated here -->
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Quick Actions</h3>
                        <div class="tesla-grid tesla-grid-2">
                            <button class="tesla-card" onclick="reportIssue()" style="cursor: pointer; text-align: left;">
                                <div style="width: 64px; height: 64px; border-radius: var(--radius-lg); background: rgba(255,68,68,0.15); display: flex; align-items: center; justify-content: center; margin-bottom: var(--spacing-lg);">
                                    <span class="material-symbols-outlined" style="font-size: 32px; color: var(--tesla-error);">warning</span>
                                </div>
                                <h4 class="font-semibold mb-sm" style="font-size: 18px;">Report Issue</h4>
                                <p class="text-secondary" style="font-size: 15px;">Report course or equipment issues</p>
                            </button>
                            <button class="tesla-card" onclick="requestBreak()" style="cursor: pointer; text-align: left;">
                                <div style="width: 64px; height: 64px; border-radius: var(--radius-lg); background: rgba(255,184,0,0.15); display: flex; align-items: center; justify-content: center; margin-bottom: var(--spacing-lg);">
                                    <span class="material-symbols-outlined" style="font-size: 32px; color: var(--tesla-warning);">coffee</span>
                                </div>
                                <h4 class="font-semibold mb-sm" style="font-size: 18px;">Request Break</h4>
                                <p class="text-secondary" style="font-size: 15px;">Take a scheduled break</p>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Active Reports</h3>
                        <div id="activeReports" class="tesla-list"></div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Communication Hub</h3>
                        <div class="tesla-grid tesla-grid-2">
                            <button class="tesla-card" onclick="openChat('caddy_master')" style="cursor: pointer; text-align: left;">
                                <span class="material-symbols-outlined mb-sm" style="font-size: 24px; color: var(--tesla-primary);">person</span>
                                <h4 class="font-semibold">Caddy Master</h4>
                            </button>
                            <button class="tesla-card" onclick="openChat('gm')" style="cursor: pointer; text-align: left;">
                                <span class="material-symbols-outlined mb-sm" style="font-size: 24px; color: var(--tesla-primary);">admin_panel_settings</span>
                                <h4 class="font-semibold">General Manager</h4>
                            </button>
                            <button class="tesla-card" onclick="openChat('proshop')" style="cursor: pointer; text-align: left;">
                                <span class="material-symbols-outlined mb-sm" style="font-size: 24px; color: var(--tesla-primary);">store</span>
                                <h4 class="font-semibold">Pro Shop</h4>
                            </button>
                            <button class="tesla-card" onclick="openChat('maintenance')" style="cursor: pointer; text-align: left;">
                                <span class="material-symbols-outlined mb-sm" style="font-size: 24px; color: var(--tesla-primary);">build</span>
                                <h4 class="font-semibold">Maintenance</h4>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Today's Schedule</h3>
                        <div id="todaySchedule" class="tesla-list"></div>
                    </div>
                </div>
                
                <!-- Communication Tab -->
                <div id="caddieCommunicationTab" class="tab-content hidden">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Messages</h3>
                        <div id="messagesList" class="tesla-list"></div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Send Message</h3>
                        <div class="tesla-card">
                            <div class="tesla-form-group">
                                <label class="tesla-label">Recipient</label>
                                <select id="messageRecipient" class="tesla-input">
                                    <option value="caddy_master">Caddy Master</option>
                                    <option value="gm">General Manager</option>
                                    <option value="proshop">Pro Shop</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                            <div class="tesla-form-group">
                                <label class="tesla-label">Message</label>
                                <textarea id="messageContent" class="tesla-input" rows="4" placeholder="Type your message..."></textarea>
                            </div>
                            <button class="tesla-btn tesla-btn-primary" onclick="sendMessage()">
                                <span class="material-symbols-outlined">send</span>
                                Send Message
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Schedule Tab -->
                <div id="caddieScheduleTab" class="tab-content hidden">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Daily Summary</h3>
                        <div class="tesla-stats-grid">
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value" id="roundsToday">3</div>
                                <div class="tesla-stat-label">Rounds Today</div>
                            </div>
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value" id="totalTips">฿1,850</div>
                                <div class="tesla-stat-label">Total Tips</div>
                            </div>
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value" id="hoursWorked">7.5</div>
                                <div class="tesla-stat-label">Hours Worked</div>
                            </div>
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value" id="avgRating">4.8</div>
                                <div class="tesla-stat-label">Avg Rating</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Schedule</h3>
                        <div id="fullSchedule" class="tesla-list"></div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Navigation -->
            <div class="tesla-bottom-nav">
                <div class="tesla-bottom-nav-content">
                    <div class="tesla-bottom-nav-item active">
                        <span class="material-symbols-outlined">home</span>
                        <span>Home</span>
                    </div>
                    <div class="tesla-bottom-nav-item" onclick="showScreen('caddieLocationScreen')">
                        <span class="material-symbols-outlined">location_on</span>
                        <span>Location</span>
                    </div>
                    <div class="tesla-bottom-nav-item" onclick="showScreen('caddieProfileScreen')">
                        <span class="material-symbols-outlined">person</span>
                        <span>Profile</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CADDIE LOCATION SCREEN -->
        <div id="caddieLocationScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">GPS Tracking</h1>
                    <div style="width: 40px;"></div>
                </div>
            </div>
            
            <div class="tesla-content">
                <div class="tesla-card mb-xl">
                    <div class="flex justify-between items-center mb-lg">
                        <div>
                            <h3 class="font-semibold mb-sm" style="font-size: 20px;">GPS Tracking</h3>
                            <p class="text-secondary">Share your location with management</p>
                        </div>
                        <label class="flex items-center gap-sm" style="cursor: pointer;">
                            <input type="checkbox" id="gpsTrackingToggle" onchange="toggleGPSTracking(this.checked)" style="width: 48px; height: 28px;">
                        </label>
                    </div>
                    <div id="gpsStatus" class="text-sm" style="padding: var(--spacing-md); background: rgba(255,184,0,0.1); border-radius: var(--radius-md); color: var(--tesla-warning);">
                        GPS tracking is currently OFF
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Current Location</h3>
                    <div class="tesla-card">
                        <div class="mb-md">
                            <div class="text-sm text-secondary mb-xs">Coordinates</div>
                            <div class="font-semibold" id="caddieGpsCoords">13.7563, 100.5018</div>
                        </div>
                        <div class="mb-md">
                            <div class="text-sm text-secondary mb-xs">Current Hole</div>
                            <div class="font-semibold" style="font-size: 32px; color: var(--tesla-primary);" id="caddieCurrentHole">7</div>
                        </div>
                        <button class="tesla-btn tesla-btn-secondary" style="width: 100%;" onclick="updateCaddieLocation()">
                            <span class="material-symbols-outlined">refresh</span>
                            Update Location
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CADDIE PROFILE SCREEN -->
        <div id="caddieProfileScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">My Profile</h1>
                    <button class="tesla-icon-btn">
                        <span class="material-symbols-outlined">edit</span>
                    </button>
                </div>
            </div>
            
            <div class="tesla-content">
                <div class="tesla-card mb-xl">
                    <div class="flex items-center gap-md">
                        <div style="width: 80px; height: 80px; border-radius: var(--radius-lg); background: rgba(62,106,225,0.15); display: flex; align-items: center; justify-content: center;">
                            <span class="material-symbols-outlined" style="font-size: 40px; color: var(--tesla-primary);">person</span>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold">Ning</h2>
                            <p class="text-sm text-secondary">Professional Caddie since 2016</p>
                            <p class="text-sm" style="color: var(--tesla-primary);">ID: CAD-001</p>
                        </div>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Performance Stats</h3>
                    <div class="tesla-stats-grid">
                        <div class="tesla-stat-card">
                            <div class="tesla-stat-value">4.9</div>
                            <div class="tesla-stat-label">Average Rating</div>
                        </div>
                        <div class="tesla-stat-card">
                            <div class="tesla-stat-value">847</div>
                            <div class="tesla-stat-label">Total Rounds</div>
                        </div>
                        <div class="tesla-stat-card">
                            <div class="tesla-stat-value">8</div>
                            <div class="tesla-stat-label">Years Experience</div>
                        </div>
                        <div class="tesla-stat-card">
                            <div class="tesla-stat-value">฿38.5k</div>
                            <div class="tesla-stat-label">Tips This Month</div>
                        </div>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Today's Summary</h3>
                    <div class="tesla-card">
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Rounds Completed:</span>
                            <span class="font-semibold">2</span>
                        </div>
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Tips Earned:</span>
                            <span class="font-semibold" style="color: var(--tesla-success);">฿1,200</span>
                        </div>
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Hours Worked:</span>
                            <span class="font-semibold">5.5</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-secondary">Status:</span>
                            <span style="color: var(--tesla-success); font-weight: 600;">Active</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- REPORT ISSUE MODAL -->
        <div id="reportIssueModal" class="tesla-modal">
            <div class="tesla-modal-backdrop" onclick="closeReportIssueModal()"></div>
            <div class="tesla-modal-content">
                <div class="tesla-modal-header">
                    <h2 class="text-lg font-semibold">Report Issue</h2>
                    <button class="tesla-icon-btn" onclick="closeReportIssueModal()">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="tesla-modal-body">
                    <div class="tesla-form-group">
                        <label class="tesla-label">Issue Type</label>
                        <select id="issueType" class="tesla-input">
                            <option value="cart_battery">Cart Battery Low</option>
                            <option value="medical">Medical Emergency</option>
                            <option value="course_damage">Course Damage</option>
                            <option value="marshall">Request Marshall</option>
                            <option value="equipment">Equipment Issue</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="tesla-form-group">
                        <label class="tesla-label">Hole Number</label>
                        <select id="issueHole" class="tesla-input">
                            <option value="1">Hole 1</option>
                            <option value="2">Hole 2</option>
                            <option value="3">Hole 3</option>
                            <option value="4">Hole 4</option>
                            <option value="5">Hole 5</option>
                            <option value="6">Hole 6</option>
                            <option value="7">Hole 7</option>
                            <option value="8">Hole 8</option>
                            <option value="9">Hole 9</option>
                            <option value="10">Hole 10</option>
                            <option value="11">Hole 11</option>
                            <option value="12">Hole 12</option>
                            <option value="13">Hole 13</option>
                            <option value="14">Hole 14</option>
                            <option value="15">Hole 15</option>
                            <option value="16">Hole 16</option>
                            <option value="17">Hole 17</option>
                            <option value="18">Hole 18</option>
                        </select>
                    </div>
                    <div class="tesla-form-group">
                        <label class="tesla-label">Additional Comments</label>
                        <textarea id="issueComments" class="tesla-input" rows="4" placeholder="Describe the issue..."></textarea>
                    </div>
                </div>
                <div class="tesla-modal-footer">
                    <button class="tesla-btn tesla-btn-secondary" onclick="closeReportIssueModal()">Cancel</button>
                    <button class="tesla-btn tesla-btn-primary" onclick="submitIssueReport()">Submit Report</button>
                </div>
            </div>
        </div>
        <div id="golferDashboard" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="logout()">
                        <span class="material-symbols-outlined">logout</span>
                    </button>
                    <h1 class="text-lg font-semibold" data-i18n="golfer_dashboard">Golfer Dashboard</h1>
                    <select id="golferLanguage" class="tesla-input" style="width: 80px; padding: 8px 12px; font-size: 13px;" onchange="switchLanguage(this.value)">
                        <option value="en">EN</option>
                        <option value="th">TH</option>
                        <option value="ko">KO</option>
                        <option value="ja">JA</option>
                    </select>
                </div>
                <div class="tesla-nav mt-md">
                    <div class="tesla-nav-item active" onclick="showGolferTab('overview')" data-i18n="overview">Overview</div>
                    <div class="tesla-nav-item" onclick="showGolferTab('bookings')" data-i18n="bookings">Bookings</div>
                    <div class="tesla-nav-item" onclick="showGolferTab('stats')" data-i18n="stats">Stats</div>
                    <div class="tesla-nav-item" onclick="showGolferTab('events')" data-i18n="events">Events</div>
                </div>
            </div>
            
            <div class="tesla-content">
                <!-- Overview Tab -->
                <div id="golferOverviewTab" class="tab-content">
                    <div class="tesla-card mb-xl animate-slide-up">
                        <div class="flex items-center gap-lg">
                            <div style="width: 80px; height: 80px; border-radius: var(--radius-lg); background: rgba(62,106,225,0.15); display: flex; align-items: center; justify-content: center;">
                                <span class="material-symbols-outlined" style="font-size: 40px; color: var(--tesla-primary);">person</span>
                            </div>
                            <div>
                                <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 8px;"><span data-i18n="welcome_back">Welcome back</span>, John!</h2>
                                <p class="text-secondary" style="font-size: 16px;"><span data-i18n="member_id">Member</span> #12345 • <span data-i18n="handicap">Handicap</span>: 18</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title" data-i18n="quick_actions">Quick Actions</h3>
                        <div class="tesla-grid tesla-grid-2">
                            <div class="tesla-card" onclick="showScreen('foodOrderingScreen')" style="cursor: pointer;">
                                <div style="width: 64px; height: 64px; border-radius: var(--radius-lg); background: rgba(62,106,225,0.15); display: flex; align-items: center; justify-content: center; margin-bottom: var(--spacing-lg);">
                                    <span class="material-symbols-outlined" style="font-size: 32px; color: var(--tesla-primary);">restaurant</span>
                                </div>
                                <h4 class="font-semibold mb-sm" style="font-size: 18px;" data-i18n="order_food">Order Food</h4>
                                <p class="text-secondary" style="font-size: 15px;" data-i18n="browse_menu">Browse menu & order</p>
                            </div>
                            <div class="tesla-card" onclick="bookCaddy()" style="cursor: pointer;">
                                <div style="width: 64px; height: 64px; border-radius: var(--radius-lg); background: rgba(0,213,99,0.15); display: flex; align-items: center; justify-content: center; margin-bottom: var(--spacing-lg);">
                                    <span class="material-symbols-outlined" style="font-size: 32px; color: var(--tesla-success);">person_add</span>
                                </div>
                                <h4 class="font-semibold mb-sm" style="font-size: 18px;" data-i18n="book_caddy">Book Caddy</h4>
                                <p class="text-secondary" style="font-size: 15px;" data-i18n="reserve_caddy">Reserve a caddy</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Upcoming Bookings</h3>
                        <div class="tesla-list">
                            <div class="tesla-list-item">
                                <div class="flex justify-between items-center">
                                    <div style="flex: 1;">
                                        <h4 class="font-semibold mb-sm" style="font-size: 18px;">Tee Time</h4>
                                        <p class="text-secondary" style="font-size: 15px; margin-bottom: 8px;">Today, 2:00 PM - Course A</p>
                                        <p style="color: var(--tesla-primary); font-size: 15px;">Caddy: Ning</p>
                                    </div>
                                    <span class="material-symbols-outlined" style="color: var(--tesla-success); font-size: 32px;">check_circle</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Active Orders</h3>
                        <div id="golferActiveOrders" class="tesla-list">
                            <div class="text-center text-secondary" style="padding: var(--spacing-xl);">
                                <span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: var(--spacing-sm);">receipt</span>
                                No active orders
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Current Location</h3>
                        <div class="tesla-card">
                            <div class="flex justify-between items-center mb-md">
                                <div class="flex items-center gap-md">
                                    <div style="width: 48px; height: 48px; border-radius: var(--radius-md); background: rgba(62,106,225,0.15); display: flex; align-items: center; justify-content: center;">
                                        <span class="material-symbols-outlined" style="color: var(--tesla-primary);">location_on</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Hole <span id="currentHole">7</span></h4>
                                        <p class="text-sm text-secondary">Course A • Par 4</p>
                                    </div>
                                </div>
                                <button class="tesla-btn-secondary" onclick="updateLocation()" style="padding: 8px 16px; font-size: 13px;">Update GPS</button>
                            </div>
                            <div style="background: rgba(62,106,225,0.1); border-radius: var(--radius-md); padding: var(--spacing-md);">
                                <div class="flex items-center gap-sm mb-sm">
                                    <span class="material-symbols-outlined text-sm" style="color: var(--tesla-primary);">my_location</span>
                                    <span class="text-sm font-semibold">GPS Coordinates</span>
                                </div>
                                <p class="text-sm text-secondary">Lat: <span id="playerLat">13.7563</span>, Lng: <span id="playerLng">100.5018</span></p>
                                <p class="text-sm text-secondary mt-sm">Distance to pin: <span id="distanceToPin">127 yards</span></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bookings Tab -->
                <div id="golferBookingsTab" class="tab-content hidden">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">My Bookings</h3>
                        <div class="tesla-list">
                            <div class="tesla-card">
                                <div class="flex justify-between items-center mb-md">
                                    <div class="flex items-center gap-md">
                                        <div style="width: 48px; height: 48px; border-radius: var(--radius-md); background: rgba(0,213,99,0.15); display: flex; align-items: center; justify-content: center;">
                                            <span class="material-symbols-outlined" style="color: var(--tesla-success);">golf_course</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold">Tee Time Confirmed</h4>
                                            <p class="text-sm text-secondary">Today, 2:00 PM - Course A</p>
                                            <p class="text-sm" style="color: var(--tesla-primary);">Caddy: Ning</p>
                                        </div>
                                    </div>
                                    <span style="padding: 4px 12px; background: rgba(0,213,99,0.15); color: var(--tesla-success); border-radius: var(--radius-full); font-size: 13px; font-weight: 500;">Confirmed</span>
                                </div>
                                <div class="flex gap-sm">
                                    <button class="tesla-btn tesla-btn-secondary" style="flex: 1; padding: 10px;" onclick="modifyBooking('today-2pm')">Modify</button>
                                    <button class="tesla-btn" style="flex: 1; padding: 10px; background: rgba(255,68,68,0.15); color: var(--tesla-error); border: 1px solid rgba(255,68,68,0.3);" onclick="cancelBooking('today-2pm')">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Tab -->
                <div id="golferStatsTab" class="tab-content hidden">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Performance Overview</h3>
                        <div class="tesla-stats-grid">
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value">18.2</div>
                                <div class="tesla-stat-label">Current Handicap</div>
                                <div class="text-sm" style="color: var(--tesla-success); margin-top: 4px;">↓ 0.3 this month</div>
                            </div>
                            <div class="tesla-stat-card">
                                <div class="tesla-stat-value">84</div>
                                <div class="tesla-stat-label">Best Score</div>
                                <div class="text-sm" style="color: var(--tesla-success); margin-top: 4px;">Last week</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Recent Rounds</h3>
                        <div class="tesla-list">
                            <div class="tesla-list-item">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-semibold">Course A</h4>
                                        <p class="text-sm text-secondary">Yesterday • Par 72</p>
                                    </div>
                                    <div class="text-center">
                                        <div style="font-size: 24px; font-weight: 600; color: var(--tesla-primary);">87</div>
                                        <div class="text-sm text-secondary">+15</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Events Tab -->
                <div id="golferEventsTab" class="tab-content hidden">
                    <div class="tesla-section">
                        <h3 class="tesla-section-title">Upcoming Events</h3>
                        <div class="tesla-list">
                            <div class="tesla-card">
                                <div class="flex justify-between items-center mb-md">
                                    <div class="flex items-center gap-md">
                                        <div style="width: 48px; height: 48px; border-radius: var(--radius-md); background: rgba(255,184,0,0.15); display: flex; align-items: center; justify-content: center;">
                                            <span class="material-symbols-outlined" style="color: var(--tesla-warning);">emoji_events</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold">Monthly Club Championship</h4>
                                            <p class="text-sm text-secondary">Saturday, Dec 23 • 8:00 AM</p>
                                            <p class="text-sm" style="color: var(--tesla-warning);">Registration closes in 2 days</p>
                                        </div>
                                    </div>
                                </div>
                                <p class="text-sm text-secondary mb-md">18-hole stroke play tournament. Winner receives club trophy and ฿10,000 prize.</p>
                                <button class="tesla-btn tesla-btn-primary" style="width: 100%;" onclick="registerEvent('championship')">Register Now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Navigation -->
            <div class="tesla-bottom-nav">
                <div class="tesla-bottom-nav-content">
                    <div class="tesla-bottom-nav-item active">
                        <span class="material-symbols-outlined">home</span>
                        <span>Home</span>
                    </div>
                    <div class="tesla-bottom-nav-item" onclick="showScreen('foodOrderingScreen')">
                        <span class="material-symbols-outlined">restaurant</span>
                        <span>Food</span>
                        <div id="cartBadge" class="tesla-badge hidden">0</div>
                    </div>
                    <div class="tesla-bottom-nav-item" onclick="showScreen('orderTrackingScreen')">
                        <span class="material-symbols-outlined">location_on</span>
                        <span>Track</span>
                    </div>
                    <div class="tesla-bottom-nav-item" onclick="showScreen('golferProfileScreen')">
                        <span class="material-symbols-outlined">person</span>
                        <span>Profile</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- FOOD ORDERING SCREEN -->
        <div id="foodOrderingScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">Food & Beverage</h1>
                    <button class="tesla-icon-btn" onclick="showScreen('cartScreen')" style="position: relative;">
                        <span class="material-symbols-outlined">shopping_cart</span>
                        <div id="cartBadgeHeader" class="tesla-badge hidden">0</div>
                    </button>
                </div>
            </div>
            
            <div class="tesla-content">
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Burgers</h3>
                    <div class="tesla-list">
                        <div class="tesla-card">
                            <div class="flex gap-md">
                                <div style="width: 80px; height: 80px; border-radius: var(--radius-md); background: linear-gradient(135deg, #8B4513, #A0522D); display: flex; align-items: center; justify-content: center;">
                                    <span class="material-symbols-outlined" style="font-size: 40px; color: white;">lunch_dining</span>
                                </div>
                                <div style="flex: 1;">
                                    <h4 class="font-semibold mb-sm">Classic Burger</h4>
                                    <p class="text-sm text-secondary mb-sm">Beef patty, lettuce, tomato, cheese, pickles</p>
                                    <div class="flex justify-between items-center">
                                        <span style="font-size: 18px; font-weight: 600; color: var(--tesla-primary);">฿280</span>
                                        <button class="tesla-btn tesla-btn-primary" style="padding: 8px 16px; font-size: 13px;" onclick="addToCart('Classic Burger', 280)">Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tesla-card">
                            <div class="flex gap-md">
                                <div style="width: 80px; height: 80px; border-radius: var(--radius-md); background: linear-gradient(135deg, #8B4513, #D2691E); display: flex; align-items: center; justify-content: center;">
                                    <span class="material-symbols-outlined" style="font-size: 40px; color: white;">fastfood</span>
                                </div>
                                <div style="flex: 1;">
                                    <h4 class="font-semibold mb-sm">BBQ Bacon Burger</h4>
                                    <p class="text-sm text-secondary mb-sm">Double beef, crispy bacon, BBQ sauce</p>
                                    <div class="flex justify-between items-center">
                                        <span style="font-size: 18px; font-weight: 600; color: var(--tesla-primary);">฿380</span>
                                        <button class="tesla-btn tesla-btn-primary" style="padding: 8px 16px; font-size: 13px;" onclick="addToCart('BBQ Bacon Burger', 380)">Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Beverages</h3>
                    <div class="tesla-list">
                        <div class="tesla-card">
                            <div class="flex gap-md">
                                <div style="width: 80px; height: 80px; border-radius: var(--radius-md); background: linear-gradient(135deg, #FFA500, #FF8C00); display: flex; align-items: center; justify-content: center;">
                                    <span class="material-symbols-outlined" style="font-size: 40px; color: white;">local_cafe</span>
                                </div>
                                <div style="flex: 1;">
                                    <h4 class="font-semibold mb-sm">Fresh Orange Juice</h4>
                                    <p class="text-sm text-secondary mb-sm">100% natural orange juice</p>
                                    <div class="flex justify-between items-center">
                                        <span style="font-size: 18px; font-weight: 600; color: var(--tesla-primary);">฿120</span>
                                        <button class="tesla-btn tesla-btn-primary" style="padding: 8px 16px; font-size: 13px;" onclick="addToCart('Fresh Orange Juice', 120)">Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CART SCREEN -->
        <div id="cartScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">Shopping Cart</h1>
                    <div style="width: 40px;"></div>
                </div>
            </div>
            
            <div class="tesla-content">
                <div id="cartItems" class="tesla-list"></div>
                <div id="emptyCart" class="text-center" style="padding: var(--spacing-2xl);">
                    <span class="material-symbols-outlined" style="font-size: 64px; opacity: 0.3; display: block; margin-bottom: var(--spacing-md);">shopping_cart</span>
                    <h3 class="font-semibold mb-sm">Your cart is empty</h3>
                    <p class="text-secondary mb-lg">Add some delicious items to get started!</p>
                    <button class="tesla-btn tesla-btn-primary" onclick="showScreen('foodOrderingScreen')">Browse Menu</button>
                </div>
            </div>
            
            <div id="cartFooter" class="hidden" style="position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-top: 1px solid var(--tesla-border); padding: var(--spacing-lg); padding-bottom: calc(var(--spacing-lg) + env(safe-area-inset-bottom));">
                <div class="flex justify-between items-center mb-md">
                    <span class="text-lg font-semibold">Total:</span>
                    <span id="cartTotal" style="font-size: 24px; font-weight: 600; color: var(--tesla-primary);">฿0</span>
                </div>
                <button class="tesla-btn tesla-btn-primary" style="width: 100%;" onclick="showScreen('checkoutScreen')">Proceed to Checkout</button>
            </div>
        </div>
        
        <!-- CHECKOUT SCREEN -->
        <div id="checkoutScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">Checkout</h1>
                    <div style="width: 40px;"></div>
                </div>
            </div>
            
            <div class="tesla-content" style="padding-bottom: 150px;">
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Delivery Options</h3>
                    <div class="tesla-list">
                        <label class="tesla-card" style="cursor: pointer;">
                            <div class="flex items-center gap-md">
                                <input type="radio" name="delivery" value="table" checked style="width: 20px; height: 20px;">
                                <div>
                                    <h4 class="font-semibold">Table Service</h4>
                                    <p class="text-sm text-secondary">Delivered to your table • 15-20 min</p>
                                </div>
                            </div>
                        </label>
                        <label class="tesla-card" style="cursor: pointer;">
                            <div class="flex items-center gap-md">
                                <input type="radio" name="delivery" value="cart" style="width: 20px; height: 20px;">
                                <div>
                                    <h4 class="font-semibold">Golf Cart Service</h4>
                                    <p class="text-sm text-secondary">Delivered to your location • 20-25 min</p>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Payment Method</h3>
                    <div class="tesla-list">
                        <label class="tesla-card" style="cursor: pointer;">
                            <div class="flex items-center gap-md">
                                <input type="radio" name="payment" value="member" checked style="width: 20px; height: 20px;">
                                <div>
                                    <h4 class="font-semibold">Member Account</h4>
                                    <p class="text-sm text-secondary">Charge to membership</p>
                                </div>
                            </div>
                        </label>
                        <label class="tesla-card" style="cursor: pointer;">
                            <div class="flex items-center gap-md">
                                <input type="radio" name="payment" value="card" style="width: 20px; height: 20px;">
                                <div>
                                    <h4 class="font-semibold">Credit Card</h4>
                                    <p class="text-sm text-secondary">Pay with card</p>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Order Summary</h3>
                    <div class="tesla-card">
                        <div class="flex justify-between mb-sm">
                            <span class="text-secondary">Subtotal:</span>
                            <span id="checkoutSubtotal">฿0</span>
                        </div>
                        <div class="flex justify-between mb-sm">
                            <span class="text-secondary">Service (10%):</span>
                            <span id="checkoutService">฿0</span>
                        </div>
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Tax (7%):</span>
                            <span id="checkoutTax">฿0</span>
                        </div>
                        <div style="border-top: 1px solid var(--tesla-border); padding-top: var(--spacing-md);">
                            <div class="flex justify-between">
                                <span class="font-semibold">Total:</span>
                                <span id="checkoutTotal" style="font-size: 24px; font-weight: 600; color: var(--tesla-primary);">฿0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-top: 1px solid var(--tesla-border); padding: var(--spacing-lg); padding-bottom: calc(var(--spacing-lg) + env(safe-area-inset-bottom));">
                <button class="tesla-btn tesla-btn-primary" style="width: 100%;" onclick="placeOrder()">Place Order</button>
            </div>
        </div>
        
        <!-- ORDER TRACKING SCREEN -->
        <div id="orderTrackingScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">Track Your Order</h1>
                    <div style="width: 40px;"></div>
                </div>
            </div>
            
            <div class="tesla-content">
                <div id="activeOrders" class="tesla-list"></div>
                <div id="noOrders" class="text-center" style="padding: var(--spacing-2xl);">
                    <span class="material-symbols-outlined" style="font-size: 64px; opacity: 0.3; display: block; margin-bottom: var(--spacing-md);">restaurant</span>
                    <h3 class="font-semibold mb-sm">No Active Orders</h3>
                    <p class="text-secondary mb-lg">Place an order to start tracking</p>
                    <button class="tesla-btn tesla-btn-primary" onclick="showScreen('foodOrderingScreen')">Order Food</button>
                </div>
            </div>
        </div>
        
        <!-- GOLFER PROFILE SCREEN -->
        <div id="golferProfileScreen" class="screen">
            <div class="tesla-header">
                <div class="tesla-header-content">
                    <button class="tesla-icon-btn" onclick="goBack()">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1 class="text-lg font-semibold">My Profile</h1>
                    <button class="tesla-icon-btn">
                        <span class="material-symbols-outlined">edit</span>
                    </button>
                </div>
            </div>
            
            <div class="tesla-content">
                <div class="tesla-card mb-lg">
                    <div class="flex items-center gap-md">
                        <div style="width: 80px; height: 80px; border-radius: var(--radius-lg); background: rgba(62,106,225,0.15); display: flex; align-items: center; justify-content: center;">
                            <span class="material-symbols-outlined" style="font-size: 40px; color: var(--tesla-primary);">person</span>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold">John Mitchell</h2>
                            <p class="text-sm text-secondary">Premium Member since 2019</p>
                            <p class="text-sm" style="color: var(--tesla-primary);">Member ID: #12345</p>
                        </div>
                    </div>
                </div>
                
                <div class="tesla-section">
                    <h3 class="tesla-section-title">Account Information</h3>
                    <div class="tesla-card">
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Email:</span>
                            <span class="font-semibold">john.mitchell@email.com</span>
                        </div>
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Phone:</span>
                            <span class="font-semibold">+66 89 123 4567</span>
                        </div>
                        <div class="flex justify-between mb-md">
                            <span class="text-secondary">Membership:</span>
                            <span class="font-semibold" style="color: var(--tesla-primary);">Premium</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-secondary">Handicap:</span>
                            <span class="font-semibold">18.2</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CADDY BOOKING MODAL -->
        <div id="caddyBookingModal" class="tesla-modal">
            <div class="tesla-modal-backdrop" onclick="closeCaddyBookingModal()"></div>
            <div class="tesla-modal-content">
                <div class="tesla-modal-header">
                    <h2 class="text-lg font-semibold">Book Caddy</h2>
                    <button class="tesla-icon-btn" onclick="closeCaddyBookingModal()">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="tesla-modal-body">
                    <div id="bookingInfo" class="mb-lg"></div>
                    
                    <div class="mb-lg">
                        <label class="tesla-label mb-sm">Filter Caddies</label>
                        <div class="flex gap-sm mb-sm">
                            <input type="text" id="caddySearchInput" class="tesla-input" placeholder="Search by name..." onkeyup="filterCaddies()">
                        </div>
                        <div class="flex gap-sm flex-wrap">
                            <button class="tesla-btn tesla-btn-ghost" style="padding: 6px 12px; font-size: 13px;" onclick="filterByAvailability('all')">All</button>
                            <button class="tesla-btn tesla-btn-ghost" style="padding: 6px 12px; font-size: 13px;" onclick="filterByAvailability('available')">Available</button>
                            <button class="tesla-btn tesla-btn-ghost" style="padding: 6px 12px; font-size: 13px;" onclick="filterByAvailability('booked')">Booked</button>
                        </div>
                    </div>
                    
                    <div id="caddyListContainer" class="tesla-list" style="max-height: 500px; overflow-y: auto;">
                        <!-- Caddy cards will be populated here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CADDY OFFER NOTIFICATION MODAL -->
        <div id="caddyOfferModal" class="tesla-modal">
            <div class="tesla-modal-backdrop"></div>
            <div class="tesla-modal-content">
                <div class="tesla-modal-header" style="background: var(--tesla-primary);">
                    <h2 class="text-lg font-semibold" style="color: white;">Caddy Available!</h2>
                </div>
                <div class="tesla-modal-body text-center">
                    <div style="width: 80px; height: 80px; margin: 0 auto var(--spacing-lg); background: rgba(62,106,225,0.15); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center;">
                        <span class="material-symbols-outlined" style="font-size: 48px; color: var(--tesla-primary);">person</span>
                    </div>
                    <h3 class="font-semibold mb-md" style="font-size: 20px;" id="offerCaddyName">Ning</h3>
                    <p class="text-secondary mb-lg" id="offerDetails">Your preferred caddy is now available for your tee time on Dec 20 at 2:00 PM</p>
                    <div class="mb-lg">
                        <div class="text-lg font-semibold mb-sm">Time Remaining</div>
                        <div id="offerCountdown" style="font-size: 48px; font-weight: 700; color: var(--tesla-primary);">10:00</div>
                    </div>
                </div>
                <div class="tesla-modal-footer">
                    <button class="tesla-btn tesla-btn-secondary" onclick="declineOffer()" style="flex: 1;">Decline</button>
                    <button class="tesla-btn tesla-btn-primary" onclick="acceptOffer()" style="flex: 1;">Accept Booking</button>
                </div>
            </div>
        </div>
        
        <!-- Toast Notification -->
        <div id="toast" class="tesla-toast"></div>
    </div>
    
    <script>
        // ===== GLOBAL STATE =====
        let currentUser = { role: 'guest', name: 'Guest User', lineUserId: null, phone: null };
        let cart = [];
        let currentScreen = 'loginScreen';
        let lastScreen = 'loginScreen';
        let currentLanguage = 'en';
        let activeOrders = [];
        let currentHole = 7;
        let playerLocation = { lat: 13.7563, lng: 100.5018 };
        
        // Authentication state
        let otpCode = '';
        let otpExpiry = null;
        let otpAttempts = 0;
        let maxOtpAttempts = 3;
        let otpCountdownInterval = null;
        let lineInitialized = false;
        let liffId = 'YOUR_LIFF_ID'; // Replace with actual LIFF ID
        
        // Caddy booking system
        let caddyDatabase = [
            { id: 1, name: 'Ning', rating: 4.9, experience: 8, language: ['EN', 'TH'], specialty: 'Course Knowledge', photo: 'caddy1', available: true, price: 800, bookings: [] },
            { id: 2, name: 'Som', rating: 4.8, experience: 6, language: ['TH', 'JA'], specialty: 'Putting Coach', photo: 'caddy2', available: true, price: 750, bookings: [] },
            { id: 3, name: 'David Kim', rating: 4.7, experience: 5, language: ['EN', 'KO'], specialty: 'Strategic Play', photo: 'caddy3', available: false, price: 900, bookings: [{ date: '2024-12-20', time: '14:00', golfer: 'John Smith' }] },
            { id: 4, name: 'Mai', rating: 4.9, experience: 10, language: ['EN', 'TH', 'JA'], specialty: 'Pro Level', photo: 'caddy4', available: true, price: 1000, bookings: [] },
            { id: 5, name: 'Pong', rating: 4.6, experience: 4, language: ['TH'], specialty: 'Beginner Friendly', photo: 'caddy5', available: true, price: 650, bookings: [] },
            { id: 6, name: 'Lisa Wang', rating: 4.8, experience: 7, language: ['EN', 'KO', 'JA'], specialty: 'Rules Expert', photo: 'caddy6', available: false, price: 850, bookings: [{ date: '2024-12-20', time: '14:00', golfer: 'Mike Johnson' }] },
            { id: 7, name: 'Lek', rating: 4.5, experience: 3, language: ['TH', 'EN'], specialty: 'Local Knowledge', photo: 'caddy7', available: true, price: 700, bookings: [] },
            { id: 8, name: 'Sarah Chen', rating: 4.9, experience: 9, language: ['EN', 'KO'], specialty: 'Tournament Caddy', photo: 'caddy8', available: false, price: 950, bookings: [{ date: '2024-12-20', time: '10:00', golfer: 'Robert Lee' }] }
        ];
        
        let waitlistQueue = {}; // { caddyId: [{ golferId, golferName, notificationSent, timestamp }] }
        let pendingOffers = []; // Active 10-min countdown offers
        let myBookings = [
            {
                id: 'BK001',
                type: 'tee_time',
                date: '2024-12-20',
                time: '14:00',
                course: 'Course A',
                holes: 18,
                players: 1,
                status: 'confirmed',
                caddyId: null,
                caddyName: null,
                bookingType: 'society', // 'society' or 'private'
                societyName: 'Bangkok Golf Society'
            }
        ];
        
        // Caddie state
        let caddieGPSTracking = false;
        let caddieCurrentAssignment = {
            golferName: 'John Mitchell',
            startTime: '14:00',
            holes: 18,
            status: 'in_progress',
            currentHole: 7
        };
        let caddieReports = [];
        let caddieMessages = [
            { id: 1, from: 'Caddy Master', message: 'Great work this morning!', time: '10:30 AM', read: true },
            { id: 2, from: 'GM', message: 'Please see me after your round', time: '11:45 AM', read: false }
        ];
        // Manager state
        let managerAlerts = [
            { id: 1, type: 'medical', severity: 'high', message: 'Medical assistance requested - Hole 7', time: '14:32', status: 'active' },
            { id: 2, type: 'weather', severity: 'medium', message: 'Storm warning - 45 minutes', time: '14:15', status: 'active' },
            { id: 3, type: 'maintenance', severity: 'low', message: 'Cart #15 - Battery low', time: '13:50', status: 'pending' }
        ];
        
        let managerStaff = {
            caddies: [
                { id: 1, name: 'Ning', status: 'active', currentHole: 7, golfer: 'John Mitchell', rating: 4.9 },
                { id: 2, name: 'Som', status: 'active', currentHole: 12, golfer: 'Sarah Chen', rating: 4.8 },
                { id: 3, name: 'David Kim', status: 'break', currentHole: null, golfer: null, rating: 4.7 },
                { id: 4, name: 'Mai', status: 'active', currentHole: 5, golfer: 'Robert Lee', rating: 4.9 },
                { id: 5, name: 'Pong', status: 'available', currentHole: null, golfer: null, rating: 4.6 }
            ],
            support: [
                { id: 1, name: 'Mike Johnson', role: 'Marshall', status: 'on_duty' },
                { id: 2, name: 'Lisa Wang', role: 'Starter', status: 'on_duty' },
                { id: 3, name: 'Tom Brown', role: 'Maintenance', status: 'on_duty' }
            ]
        };
        
        let courseConditions = {
            greens: Array.from({length: 18}, (_, i) => ({ 
                hole: i + 1, 
                condition: 'excellent', 
                speed: 10.5 + Math.random(), 
                lastUpdated: '2 hours ago' 
            })),
            fairways: Array.from({length: 18}, (_, i) => ({ 
                hole: i + 1, 
                condition: 'good', 
                lastUpdated: '3 hours ago' 
            }))
        };
        
        // ===== TRANSLATION SYSTEM =====
        const translations = {
            en: {
                // Login
                'app_title': 'MyCaddyPro',
                'app_subtitle': 'Premium Golf Course Management',
                'language': 'Language',
                'username': 'Username',
                'password': 'Password',
                'enter_username': 'Enter username',
                'enter_password': 'Enter password',
                'remember_me': 'Remember me',
                'forgot_password': 'Forgot password?',
                'login_as_golfer': 'Login as Golfer',
                'login_as_caddie': 'Login as Caddie',
                'login_as_manager': 'Login as Manager',
                'login_as_proshop': 'Login as Pro Shop',
                'continue_as_guest': 'Continue as Guest',
                
                // Dashboard
                'golfer_dashboard': 'Golfer Dashboard',
                'welcome_back': 'Welcome back',
                'member_id': 'Member',
                'handicap': 'Handicap',
                
                // Tabs
                'overview': 'Overview',
                'bookings': 'Bookings',
                'stats': 'Stats',
                'events': 'Events',
                
                // Quick Actions
                'quick_actions': 'Quick Actions',
                'order_food': 'Order Food',
                'browse_menu': 'Browse menu & order',
                'book_caddy': 'Book Caddy',
                'reserve_caddy': 'Reserve a caddy',
                
                // Bookings
                'upcoming_bookings': 'Upcoming Bookings',
                'tee_time': 'Tee Time',
                'today': 'Today',
                'course': 'Course',
                'caddy': 'Caddy',
                
                // Orders
                'active_orders': 'Active Orders',
                'no_active_orders': 'No active orders',
                
                // Location
                'current_location': 'Current Location',
                'hole': 'Hole',
                'par': 'Par',
                'update_gps': 'Update GPS',
                'gps_coordinates': 'GPS Coordinates',
                'distance_to_pin': 'Distance to pin',
                'yards': 'yards',
                
                // Food
                'food_beverage': 'Food & Beverage',
                'burgers': 'Burgers',
                'beverages': 'Beverages',
                'classic_burger': 'Classic Burger',
                'classic_burger_desc': 'Beef patty, lettuce, tomato, cheese, pickles',
                'bbq_bacon_burger': 'BBQ Bacon Burger',
                'bbq_bacon_burger_desc': 'Double beef, crispy bacon, BBQ sauce',
                'fresh_orange_juice': 'Fresh Orange Juice',
                'fresh_orange_juice_desc': '100% natural orange juice',
                'add': 'Add',
                
                // Cart
                'shopping_cart': 'Shopping Cart',
                'cart_empty': 'Your cart is empty',
                'cart_empty_desc': 'Add some delicious items to get started!',
                'browse_menu_btn': 'Browse Menu',
                'total': 'Total',
                'proceed_checkout': 'Proceed to Checkout',
                'each': 'each',
                'remove': 'Remove',
                
                // Checkout
                'checkout': 'Checkout',
                'delivery_options': 'Delivery Options',
                'table_service': 'Table Service',
                'table_service_desc': 'Delivered to your table • 15-20 min',
                'golf_cart_service': 'Golf Cart Service',
                'golf_cart_service_desc': 'Delivered to your location • 20-25 min',
                'payment_method': 'Payment Method',
                'member_account': 'Member Account',
                'member_account_desc': 'Charge to membership',
                'credit_card': 'Credit Card',
                'credit_card_desc': 'Pay with card',
                'order_summary': 'Order Summary',
                'subtotal': 'Subtotal',
                'service_charge': 'Service (10%)',
                'tax': 'Tax (7%)',
                'place_order': 'Place Order',
                
                // Order Tracking
                'track_order': 'Track Your Order',
                'no_orders': 'No Active Orders',
                'no_orders_desc': 'Place an order to start tracking',
                'order_food_btn': 'Order Food',
                'items': 'items',
                'preparing': 'Preparing',
                'cooking': 'Cooking',
                'out_for_delivery': 'Out for Delivery',
                'delivered': 'Delivered',
                'eta': 'ETA',
                'progress': 'Progress',
                
                // Profile
                'my_profile': 'My Profile',
                'premium_member': 'Premium Member since',
                'account_info': 'Account Information',
                'email': 'Email',
                'phone': 'Phone',
                'membership': 'Membership',
                'premium': 'Premium',
                
                // Stats Tab
                'performance_overview': 'Performance Overview',
                'current_handicap': 'Current Handicap',
                'this_month': 'this month',
                'best_score': 'Best Score',
                'last_week': 'Last week',
                'recent_rounds': 'Recent Rounds',
                'yesterday': 'Yesterday',
                
                // Events Tab
                'upcoming_events': 'Upcoming Events',
                'monthly_championship': 'Monthly Club Championship',
                'registration_closes': 'Registration closes in',
                'days': 'days',
                'championship_desc': '18-hole stroke play tournament. Winner receives club trophy and ฿10,000 prize.',
                'register_now': 'Register Now',
                
                // Common
                'home': 'Home',
                'food': 'Food',
                'track': 'Track',
                'profile': 'Profile'
            },
            th: {
                // Login
                'app_title': 'MyCaddyPro',
                'app_subtitle': 'ระบบจัดการสนามกอลฟ์แบบพรีเมียม',
                'language': 'ภาษา',
                'username': 'ชื่อผู้ใช้',
                'password': 'รหัสผ่าน',
                'enter_username': 'กรอกชื่อผู้ใช้',
                'enter_password': 'กรอกรหัสผ่าน',
                'remember_me': 'จดจำฉัน',
                'forgot_password': 'ลืมรหัสผ่าน?',
                'login_as_golfer': 'เข้าสู่ระบบในฐานะนักกอลฟ์',
                'login_as_caddie': 'เข้าสู่ระบบในฐานะแคดดี้',
                'login_as_manager': 'เข้าสู่ระบบในฐานะผู้จัดการ',
                'login_as_proshop': 'เข้าสู่ระบบในฐานะร้านโปรช้อป',
                'continue_as_guest': 'ดำเนินการต่อในฐานะแขก',
                
                // Dashboard
                'golfer_dashboard': 'แดชบอร์ดนักกอลฟ์',
                'welcome_back': 'ยินดีต้อนรับกลับ',
                'member_id': 'สมาชิก',
                'handicap': 'แฮนดิแคป',
                
                // Tabs
                'overview': 'ภาพรวม',
                'bookings': 'การจอง',
                'stats': 'สถิติ',
                'events': 'กิจกรรม',
                
                // Quick Actions
                'quick_actions': 'การดำเนินการด่วน',
                'order_food': 'สั่งอาหาร',
                'browse_menu': 'เรียกดูเมนูและสั่งอาหาร',
                'book_caddy': 'จองแคดดี้',
                'reserve_caddy': 'จองแคดดี้',
                
                // Bookings
                'upcoming_bookings': 'การจองที่กำลังจะมาถึง',
                'tee_time': 'เวลาทีออฟ',
                'today': 'วันนี้',
                'course': 'สนาม',
                'caddy': 'แคดดี้',
                
                // Orders
                'active_orders': 'คำสั่งซื้อที่ดำเนินการอยู่',
                'no_active_orders': 'ไม่มีคำสั่งซื้อที่ดำเนินการอยู่',
                
                // Location
                'current_location': 'ตำแหน่งปัจจุบัน',
                'hole': 'หลุม',
                'par': 'พาร์',
                'update_gps': 'อัปเดต GPS',
                'gps_coordinates': 'พิกัด GPS',
                'distance_to_pin': 'ระยะทางถึงหมุด',
                'yards': 'หลา',
                
                // Food
                'food_beverage': 'อาหารและเครื่องดื่ม',
                'burgers': 'เบอร์เกอร์',
                'beverages': 'เครื่องดื่ม',
                'classic_burger': 'เบอร์เกอร์คลาสสิก',
                'classic_burger_desc': 'เนื้อวัว ผักกาดหอม มะเขือเทศ ชีส ผักดอง',
                'bbq_bacon_burger': 'เบอร์เกอร์เบคอน BBQ',
                'bbq_bacon_burger_desc': 'เนื้อวัวดับเบิล เบคอนกรอบ ซอส BBQ',
                'fresh_orange_juice': 'น้ำส้มสด',
                'fresh_orange_juice_desc': 'น้ำส้มธรรมชาติ 100%',
                'add': 'เพิ่ม',
                
                // Cart
                'shopping_cart': 'ตะกร้าสินค้า',
                'cart_empty': 'ตะกร้าของคุณว่างเปล่า',
                'cart_empty_desc': 'เพิ่มสินค้าอร่อยๆ เพื่อเริ่มต้น!',
                'browse_menu_btn': 'เรียกดูเมนู',
                'total': 'รวม',
                'proceed_checkout': 'ดำเนินการชำระเงิน',
                'each': 'ต่อชิ้น',
                'remove': 'ลบ',
                
                // Checkout
                'checkout': 'ชำระเงิน',
                'delivery_options': 'ตัวเลือกการจัดส่ง',
                'table_service': 'บริการที่โต๊ะ',
                'table_service_desc': 'ส่งถึงโต๊ะของคุณ • 15-20 นาที',
                'golf_cart_service': 'บริการรถกอลฟ์',
                'golf_cart_service_desc': 'ส่งถึงตำแหน่งของคุณ • 20-25 นาที',
                'payment_method': 'วิธีการชำระเงิน',
                'member_account': 'บัญชีสมาชิก',
                'member_account_desc': 'เรียกเก็บจากบัญชีสมาชิก',
                'credit_card': 'บัตรเครดิต',
                'credit_card_desc': 'ชำระด้วยบัตร',
                'order_summary': 'สรุปคำสั่งซื้อ',
                'subtotal': 'ยอดรวมย่อย',
                'service_charge': 'ค่าบริการ (10%)',
                'tax': 'ภาษี (7%)',
                'place_order': 'สั่งซื้อ',
                
                // Order Tracking
                'track_order': 'ติดตามคำสั่งซื้อของคุณ',
                'no_orders': 'ไม่มีคำสั่งซื้อที่ดำเนินการอยู่',
                'no_orders_desc': 'สั่งซื้อเพื่อเริ่มติดตาม',
                'order_food_btn': 'สั่งอาหาร',
                'items': 'รายการ',
                'preparing': 'กำลังเตรียม',
                'cooking': 'กำลังทำอาหาร',
                'out_for_delivery': 'กำลังจัดส่ง',
                'delivered': 'ส่งแล้ว',
                'eta': 'เวลาโดยประมาณ',
                'progress': 'ความคืบหน้า',
                
                // Profile
                'my_profile': 'โปรไฟล์ของฉัน',
                'premium_member': 'สมาชิกพรีเมียมตั้งแต่',
                'account_info': 'ข้อมูลบัญชี',
                'email': 'อีเมล',
                'phone': 'โทรศัพท์',
                'membership': 'การเป็นสมาชิก',
                'premium': 'พรีเมียม',
                
                // Stats Tab
                'performance_overview': 'ภาพรวมผลการเล่น',
                'current_handicap': 'แฮนดิแคปปัจจุบัน',
                'this_month': 'เดือนนี้',
                'best_score': 'คะแนนที่ดีที่สุด',
                'last_week': 'สัปดาห์ที่แล้ว',
                'recent_rounds': 'รอบล่าสุด',
                'yesterday': 'เมื่อวาน',
                
                // Events Tab
                'upcoming_events': 'กิจกรรมที่กำลังจะมาถึง',
                'monthly_championship': 'การแข่งขันรายเดือนของสโมสร',
                'registration_closes': 'ปิดการลงทะเบียนใน',
                'days': 'วัน',
                'championship_desc': 'การแข่งขัน 18 หลุม ผู้ชนะจะได้รับถ้วยรางวัลและเงินรางวัล ฿10,000',
                'register_now': 'ลงทะเบียนตอนนี้',
                
                // Common
                'home': 'หน้าแรก',
                'food': 'อาหาร',
                'track': 'ติดตาม',
                'profile': 'โปรไฟล์'
            },
            ko: {
                // Login
                'app_title': 'MyCaddyPro',
                'app_subtitle': '프리미엄 골프장 관리 시스템',
                'language': '언어',
                'username': '사용자명',
                'password': '비밀번호',
                'enter_username': '사용자명 입력',
                'enter_password': '비밀번호 입력',
                'remember_me': '로그인 상태 유지',
                'forgot_password': '비밀번호를 잊으셨나요?',
                'login_as_golfer': '골퍼로 로그인',
                'login_as_caddie': '캐디로 로그인',
                'login_as_manager': '매니저로 로그인',
                'login_as_proshop': '프로샵으로 로그인',
                'continue_as_guest': '게스트로 계속하기',
                
                // Dashboard
                'golfer_dashboard': '골퍼 대시보드',
                'welcome_back': '환영합니다',
                'member_id': '회원',
                'handicap': '핸디캡',
                
                // Tabs
                'overview': '개요',
                'bookings': '예약',
                'stats': '통계',
                'events': '이벤트',
                
                // Quick Actions
                'quick_actions': '빠른 작업',
                'order_food': '음식 주문',
                'browse_menu': '메뉴 보기 및 주문',
                'book_caddy': '캐디 예약',
                'reserve_caddy': '캐디 예약하기',
                
                // Bookings
                'upcoming_bookings': '예정된 예약',
                'tee_time': '티 타임',
                'today': '오늘',
                'course': '코스',
                'caddy': '캐디',
                
                // Orders
                'active_orders': '활성 주문',
                'no_active_orders': '활성 주문 없음',
                
                // Location
                'current_location': '현재 위치',
                'hole': '홀',
                'par': '파',
                'update_gps': 'GPS 업데이트',
                'gps_coordinates': 'GPS 좌표',
                'distance_to_pin': '핀까지 거리',
                'yards': '야드',
                
                // Food
                'food_beverage': '음식 및 음료',
                'burgers': '버거',
                'beverages': '음료',
                'classic_burger': '클래식 버거',
                'classic_burger_desc': '비프 패티, 양상추, 토마토, 치즈, 피클',
                'bbq_bacon_burger': 'BBQ 베이컨 버거',
                'bbq_bacon_burger_desc': '더블 비프, 바삭한 베이컨, BBQ 소스',
                'fresh_orange_juice': '신선한 오렌지 주스',
                'fresh_orange_juice_desc': '100% 천연 오렌지 주스',
                'add': '추가',
                
                // Cart
                'shopping_cart': '장바구니',
                'cart_empty': '장바구니가 비어 있습니다',
                'cart_empty_desc': '맛있는 상품을 추가하여 시작하세요!',
                'browse_menu_btn': '메뉴 보기',
                'total': '합계',
                'proceed_checkout': '결제하기',
                'each': '개당',
                'remove': '제거',
                
                // Checkout
                'checkout': '결제',
                'delivery_options': '배달 옵션',
                'table_service': '테이블 서비스',
                'table_service_desc': '테이블로 배달 • 15-20분',
                'golf_cart_service': '골프 카트 서비스',
                'golf_cart_service_desc': '위치로 배달 • 20-25분',
                'payment_method': '결제 수단',
                'member_account': '회원 계정',
                'member_account_desc': '회원 계정으로 청구',
                'credit_card': '신용카드',
                'credit_card_desc': '카드로 결제',
                'order_summary': '주문 요약',
                'subtotal': '소계',
                'service_charge': '서비스 수수료 (10%)',
                'tax': '세금 (7%)',
                'place_order': '주문하기',
                
                // Order Tracking
                'track_order': '주문 추적',
                'no_orders': '활성 주문 없음',
                'no_orders_desc': '주문하여 추적 시작',
                'order_food_btn': '음식 주문',
                'items': '항목',
                'preparing': '준비 중',
                'cooking': '조리 중',
                'out_for_delivery': '배달 중',
                'delivered': '배달 완료',
                'eta': '예상 시간',
                'progress': '진행률',
                
                // Profile
                'my_profile': '내 프로필',
                'premium_member': '프리미엄 회원',
                'account_info': '계정 정보',
                'email': '이메일',
                'phone': '전화',
                'membership': '회원권',
                'premium': '프리미엄',
                
                // Stats Tab
                'performance_overview': '성과 개요',
                'current_handicap': '현재 핸디캡',
                'this_month': '이번 달',
                'best_score': '최고 점수',
                'last_week': '지난 주',
                'recent_rounds': '최근 라운드',
                'yesterday': '어제',
                
                // Events Tab
                'upcoming_events': '예정된 이벤트',
                'monthly_championship': '월간 클럽 챔피언십',
                'registration_closes': '등록 마감',
                'days': '일',
                'championship_desc': '18홀 스트로크 플레이 토너먼트. 우승자는 클럽 트로피와 ฿10,000 상금을 받습니다.',
                'register_now': '지금 등록',
                
                // Common
                'home': '홈',
                'food': '음식',
                'track': '추적',
                'profile': '프로필'
            },
            ja: {
                // Login
                'app_title': 'MyCaddyPro',
                'app_subtitle': 'プレミアムゴルフコース管理システム',
                'language': '言語',
                'username': 'ユーザー名',
                'password': 'パスワード',
                'enter_username': 'ユーザー名を入力',
                'enter_password': 'パスワードを入力',
                'remember_me': 'ログイン状態を保持',
                'forgot_password': 'パスワードをお忘れですか？',
                'login_as_golfer': 'ゴルファーとしてログイン',
                'login_as_caddie': 'キャディーとしてログイン',
                'login_as_manager': 'マネージャーとしてログイン',
                'login_as_proshop': 'プロショップとしてログイン',
                'continue_as_guest': 'ゲストとして続行',
                
                // Dashboard
                'golfer_dashboard': 'ゴルファーダッシュボード',
                'welcome_back': 'おかえりなさい',
                'member_id': '会員',
                'handicap': 'ハンディキャップ',
                
                // Tabs
                'overview': '概要',
                'bookings': '予約',
                'stats': '統計',
                'events': 'イベント',
                
                // Quick Actions
                'quick_actions': 'クイックアクション',
                'order_food': '食事注文',
                'browse_menu': 'メニューを見る＆注文',
                'book_caddy': 'キャディー予約',
                'reserve_caddy': 'キャディーを予約',
                
                // Bookings
                'upcoming_bookings': '今後の予約',
                'tee_time': 'ティータイム',
                'today': '今日',
                'course': 'コース',
                'caddy': 'キャディー',
                
                // Orders
                'active_orders': 'アクティブな注文',
                'no_active_orders': 'アクティブな注文はありません',
                
                // Location
                'current_location': '現在地',
                'hole': 'ホール',
                'par': 'パー',
                'update_gps': 'GPS更新',
                'gps_coordinates': 'GPS座標',
                'distance_to_pin': 'ピンまでの距離',
                'yards': 'ヤード',
                
                // Food
                'food_beverage': '食べ物＆飲み物',
                'burgers': 'バーガー',
                'beverages': '飲み物',
                'classic_burger': 'クラシックバーガー',
                'classic_burger_desc': 'ビーフパティ、レタス、トマト、チーズ、ピクルス',
                'bbq_bacon_burger': 'BBQベーコンバーガー',
                'bbq_bacon_burger_desc': 'ダブルビーフ、カリカリベーコン、BBQソース',
                'fresh_orange_juice': 'フレッシュオレンジジュース',
                'fresh_orange_juice_desc': '100%天然オレンジジュース',
                'add': '追加',
                
                // Cart
                'shopping_cart': 'ショッピングカート',
                'cart_empty': 'カートは空です',
                'cart_empty_desc': '美味しいアイテムを追加して始めましょう！',
                'browse_menu_btn': 'メニューを見る',
                'total': '合計',
                'proceed_checkout': 'チェックアウトへ進む',
                'each': '各',
                'remove': '削除',
                
                // Checkout
                'checkout': 'チェックアウト',
                'delivery_options': '配達オプション',
                'table_service': 'テーブルサービス',
                'table_service_desc': 'テーブルへ配達 • 15-20分',
                'golf_cart_service': 'ゴルフカートサービス',
                'golf_cart_service_desc': 'あなたの場所へ配達 • 20-25分',
                'payment_method': '支払い方法',
                'member_account': '会員アカウント',
                'member_account_desc': '会員アカウントへ請求',
                'credit_card': 'クレジットカード',
                'credit_card_desc': 'カードで支払う',
                'order_summary': '注文概要',
                'subtotal': '小計',
                'service_charge': 'サービス料 (10%)',
                'tax': '税 (7%)',
                'place_order': '注文する',
                
                // Order Tracking
                'track_order': '注文を追跡',
                'no_orders': 'アクティブな注文はありません',
                'no_orders_desc': '注文して追跡を開始',
                'order_food_btn': '食事注文',
                'items': 'アイテム',
                'preparing': '準備中',
                'cooking': '調理中',
                'out_for_delivery': '配達中',
                'delivered': '配達済み',
                'eta': '到着予定時刻',
                'progress': '進行状況',
                
                // Profile
                'my_profile': 'マイプロフィール',
                'premium_member': 'プレミアム会員',
                'account_info': 'アカウント情報',
                'email': 'メール',
                'phone': '電話',
                'membership': '会員資格',
                'premium': 'プレミアム',
                
                // Stats Tab
                'performance_overview': 'パフォーマンス概要',
                'current_handicap': '現在のハンディキャップ',
                'this_month': '今月',
                'best_score': 'ベストスコア',
                'last_week': '先週',
                'recent_rounds': '最近のラウンド',
                'yesterday': '昨日',
                
                // Events Tab
                'upcoming_events': '今後のイベント',
                'monthly_championship': '月例クラブチャンピオンシップ',
                'registration_closes': '登録締切',
                'days': '日',
                'championship_desc': '18ホールストロークプレイトーナメント。優勝者はクラブトロフィーと฿10,000の賞金を受け取ります。',
                'register_now': '今すぐ登録',
                
                // Common
                'home': 'ホーム',
                'food': '食事',
                'track': '追跡',
                'profile': 'プロフィール'
            }
        };
        
        function t(key) {
            return translations[currentLanguage][key] || key;
        }
        
        function updateAllText() {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (element.tagName === 'INPUT' && element.placeholder) {
                    element.placeholder = t(key);
                } else {
                    element.textContent = t(key);
                }
            });
        }
        
        function switchLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLanguage', lang);
            
            // Update all language selectors
            const selectors = ['languageSelect', 'golferLanguage'];
            selectors.forEach(id => {
                const selector = document.getElementById(id);
                if (selector) {
                    selector.value = lang;
                }
            });
            
            updateAllText();
        }
        
        // ===== AUTHENTICATION FUNCTIONS =====
        
        // Initialize LINE LIFF
        async function initializeLiff() {
            if (lineInitialized) return true;
            
            try {
                // Check if LIFF SDK is loaded
                if (typeof liff === 'undefined') {
                    console.log('LIFF SDK not loaded - using simulation mode');
                    return false;
                }
                
                await liff.init({ liffId: liffId });
                lineInitialized = true;
                console.log('LIFF initialized successfully');
                return true;
            } catch (error) {
                console.error('LIFF initialization failed:', error);
                return false;
            }
        }
        
        // Login with LINE
        async function loginWithLine() {
            const liffReady = await initializeLiff();
            
            if (!liffReady) {
                // Simulation mode for development
                showNotificationToast('LINE login simulation - would redirect to LINE authentication in production');
                simulateLineLogin();
                return;
            }
            
            try {
                if (!liff.isLoggedIn()) {
                    liff.login();
                } else {
                    // Get LINE profile
                    const profile = await liff.getProfile();
                    
                    currentUser = {
                        role: 'golfer',
                        name: profile.displayName,
                        lineUserId: profile.userId,
                        phone: null,
                        avatar: profile.pictureUrl
                    };
                    
                    // Check if user exists in database
                    const userExists = await checkUserInDatabase(profile.userId);
                    
                    if (userExists) {
                        showScreen('golferDashboard');
                        showNotificationToast('Welcome back, ' + profile.displayName + '!');
                    } else {
                        // New user - collect phone number
                        showScreen('phoneRegistrationScreen');
                    }
                }
            } catch (error) {
                console.error('LINE login error:', error);
                showNotificationToast('LINE login failed. Please try again.');
            }
        }
        
        // Simulate LINE login for development
        function simulateLineLogin() {
            currentUser = {
                role: 'golfer',
                name: 'John Mitchell',
                lineUserId: 'U1234567890abcdef',
                phone: '+66891234567',
                avatar: null
            };
            
            showScreen('golferDashboard');
            showNotificationToast('Welcome back, John Mitchell!');
        }
        
        // Request OTP
        function requestOtp() {
            const phoneInput = document.getElementById('phoneNumber');
            const phone = phoneInput.value.trim();
            
            // Validate phone number
            if (!phone) {
                showNotificationToast('Please enter your phone number');
                phoneInput.focus();
                return;
            }
            
            if (!validatePhoneNumber(phone)) {
                showNotificationToast('Please enter a valid phone number');
                phoneInput.focus();
                return;
            }
            
            // Generate 6-digit OTP
            otpCode = generateOtpCode();
            otpExpiry = Date.now() + (2 * 60 * 1000); // 2 minutes
            otpAttempts = 0;
            
            // In production, send OTP via SMS API
            console.log('OTP Code (for testing):', otpCode);
            showNotificationToast('OTP sent to ' + phone + ' (Check console for code)');
            
            // Store phone number
            currentUser.phone = phone;
            
            // Show OTP screen
            document.getElementById('otpPhoneDisplay').textContent = maskPhoneNumber(phone);
            showScreen('otpScreen');
            
            // Start countdown
            startOtpCountdown();
            startResendCountdown();
        }
        
        // Generate OTP code
        function generateOtpCode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }
        
        // Validate phone number
        function validatePhoneNumber(phone) {
            // Basic validation - accepts formats like +66891234567, 0891234567
            const phoneRegex = /^(\+66|0)[0-9]{9}$/;
            return phoneRegex.test(phone.replace(/\s/g, ''));
        }
        
        // Mask phone number for display
        function maskPhoneNumber(phone) {
            const cleaned = phone.replace(/\s/g, '');
            if (cleaned.length <= 4) return cleaned;
            return cleaned.substring(0, cleaned.length - 4) + '****';
        }
        
        // Handle OTP input
        function handleOtpInput(input) {
            // Only allow numbers
            input.value = input.value.replace(/[^0-9]/g, '');
            
            // Auto-verify when 6 digits entered
            if (input.value.length === 6) {
                setTimeout(() => verifyOtp(), 300);
            }
            
            // Clear error
            document.getElementById('otpError').style.display = 'none';
        }
        
        // Verify OTP
        function verifyOtp() {
            const input = document.getElementById('otpInput').value;
            const errorDiv = document.getElementById('otpError');
            
            if (input.length !== 6) {
                errorDiv.textContent = 'Please enter 6-digit code';
                errorDiv.style.display = 'block';
                return;
            }
            
            // Check if OTP expired
            if (Date.now() > otpExpiry) {
                errorDiv.textContent = 'OTP code expired. Please request a new one.';
                errorDiv.style.display = 'block';
                return;
            }
            
            // Verify code
            if (input === otpCode) {
                // Success!
                if (otpCountdownInterval) {
                    clearInterval(otpCountdownInterval);
                }
                
                currentUser.role = 'golfer';
                currentUser.name = 'John Mitchell'; // In production, fetch from database
                
                showNotificationToast('Phone verified successfully!');
                showScreen('golferDashboard');
            } else {
                // Wrong code
                otpAttempts++;
                const remaining = maxOtpAttempts - otpAttempts;
                
                document.getElementById('otpAttemptsRemaining').textContent = remaining;
                
                if (remaining <= 0) {
                    errorDiv.textContent = 'Maximum attempts exceeded. Please request a new code.';
                    errorDiv.style.display = 'block';
                    document.getElementById('otpInput').disabled = true;
                } else {
                    errorDiv.textContent = 'Invalid code. ' + remaining + ' attempts remaining.';
                    errorDiv.style.display = 'block';
                    document.getElementById('otpInput').value = '';
                    document.getElementById('otpInput').focus();
                }
            }
        }
        
        // Start OTP countdown timer
        function startOtpCountdown() {
            if (otpCountdownInterval) {
                clearInterval(otpCountdownInterval);
            }
            
            const countdownElement = document.getElementById('otpCountdown');
            
            otpCountdownInterval = setInterval(() => {
                const remaining = Math.max(0, otpExpiry - Date.now());
                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                
                countdownElement.textContent = 
                    minutes.toString().padStart(2, '0') + ':' + 
                    seconds.toString().padStart(2, '0');
                
                if (remaining <= 0) {
                    clearInterval(otpCountdownInterval);
                    countdownElement.style.color = 'var(--tesla-error)';
                }
            }, 100);
        }
        
        // Start resend countdown
        function startResendCountdown() {
            const resendBtn = document.getElementById('resendOtpBtn');
            const countdownSpan = document.getElementById('resendCountdown');
            let countdown = 60;
            
            resendBtn.disabled = true;
            
            const interval = setInterval(() => {
                countdown--;
                countdownSpan.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(interval);
                    resendBtn.disabled = false;
                    resendBtn.innerHTML = '<span class="material-symbols-outlined">refresh</span><span>Resend Code</span>';
                }
            }, 1000);
        }
        
        // Resend OTP
        function resendOtp() {
            requestOtp();
        }
        
        // Back to login
        function backToLogin() {
            if (otpCountdownInterval) {
                clearInterval(otpCountdownInterval);
            }
            showScreen('loginScreen');
        }
        
        // Show role selection
        function showRoleSelection() {
            showScreen('roleSelectionScreen');
        }
        
        // Check if user exists in database
        async function checkUserInDatabase(lineUserId) {
            // In production, make API call to check if user exists
            // For now, simulate with random check
            return Math.random() > 0.3;
        }
        
        // Show forgot password
        function showForgotPassword() {
            showNotificationToast('Forgot password feature - would show password reset flow');
        }
        
        function login(role) {
            currentUser.role = role;
            
            switch(role) {
                case 'golfer':
                    currentUser.name = 'John Mitchell';
                    showScreen('golferDashboard');
                    break;
                case 'caddie':
                    currentUser.name = 'Ning';
                    showScreen('caddieDashboard');
                    break;
                case 'manager':
                    currentUser.name = 'Sarah Wilson';
                    showScreen('managerDashboard');
                    break;
                case 'proshop':
                    currentUser.name = 'Robert Chen';
                    showScreen('proshopDashboard');
                    break;
                default:
                    currentUser.name = 'Guest User';
                    showScreen('golferDashboard');
            }
            
            showNotificationToast('Welcome ' + currentUser.name + '!');
        }
        
        function logout() {
            // Close LINE session if logged in via LINE
            if (lineInitialized && typeof liff !== 'undefined' && liff.isLoggedIn()) {
                liff.logout();
            }
            
            currentUser = { role: 'guest', name: 'Guest User', lineUserId: null, phone: null };
            cart = [];
            updateCartBadge();
            showScreen('loginScreen');
            showNotificationToast('Logged out successfully');
        }
        
        // ===== SCREEN NAVIGATION =====
        function showScreen(screenId) {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => {
                screen.classList.remove('active');
            });
            
            if (currentScreen !== screenId) {
                lastScreen = currentScreen;
            }
            
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenId;
                
                // Update specific screens
                if (screenId === 'cartScreen') {
                    updateCartDisplay();
                }
                if (screenId === 'checkoutScreen') {
                    updateCheckoutDisplay();
                }
                if (screenId === 'orderTrackingScreen') {
                    updateOrderTracking();
                }
                if (screenId === 'golferDashboard') {
                    updateGolferDashboard();
                }
            }
        }
        
        function goBack() {
            if (lastScreen && lastScreen !== currentScreen) {
                showScreen(lastScreen);
            } else {
                switch(currentScreen) {
                    case 'foodOrderingScreen':
                    case 'cartScreen':
                    case 'checkoutScreen':
                    case 'orderTrackingScreen':
                    case 'golferProfileScreen':
                        showScreen('golferDashboard');
                        break;
                    default:
                        showScreen(currentUser.role + 'Dashboard');
                }
            }
        }
        
        // ===== TAB NAVIGATION =====
        function showGolferTab(tabName) {
            const tabs = document.querySelectorAll('#golferDashboard .tesla-nav-item');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            const activeTab = Array.from(tabs).find(tab => tab.textContent.toLowerCase().includes(tabName));
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            const tabContents = document.querySelectorAll('#golferDashboard .tab-content');
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            const targetContent = document.getElementById('golfer' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab');
            if (targetContent) {
                targetContent.classList.remove('hidden');
            }
        }
        
        // ===== CART FUNCTIONS =====
        function addToCart(itemName, price) {
            const existingItem = cart.find(item => item.name === itemName);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    name: itemName,
                    price: price,
                    quantity: 1
                });
            }
            
            updateCartBadge();
            showToast(itemName + ' added to cart');
        }
        
        function removeFromCart(itemName) {
            const itemIndex = cart.findIndex(item => item.name === itemName);
            if (itemIndex > -1) {
                cart.splice(itemIndex, 1);
                updateCartBadge();
                updateCartDisplay();
                showToast('Item removed from cart');
            }
        }
        
        function updateCartQuantity(itemName, quantity) {
            const item = cart.find(item => item.name === itemName);
            if (item) {
                item.quantity = Math.max(0, quantity);
                if (item.quantity === 0) {
                    removeFromCart(itemName);
                } else {
                    updateCartBadge();
                    updateCartDisplay();
                }
            }
        }
        
        function updateCartBadge() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const badges = [document.getElementById('cartBadge'), document.getElementById('cartBadgeHeader')];
            
            badges.forEach(badge => {
                if (badge) {
                    if (totalItems > 0) {
                        badge.textContent = totalItems;
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }
                }
            });
        }
        
        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            const emptyCartContainer = document.getElementById('emptyCart');
            const cartFooter = document.getElementById('cartFooter');
            
            if (!cartItemsContainer || !emptyCartContainer || !cartFooter) return;
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '';
                emptyCartContainer.style.display = 'block';
                cartFooter.classList.add('hidden');
                return;
            }
            
            emptyCartContainer.style.display = 'none';
            cartFooter.classList.remove('hidden');
            
            let cartHTML = '';
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                cartHTML += '<div class="tesla-card"><div class="flex justify-between items-center"><div style="flex: 1;"><h4 class="font-semibold mb-sm">' + item.name + '</h4><p class="text-sm text-secondary">฿' + item.price + ' each</p></div><div class="flex items-center gap-sm"><button class="tesla-icon-btn" onclick="updateCartQuantity(\'' + item.name + '\', ' + (item.quantity - 1) + ')"><span class="material-symbols-outlined">remove</span></button><span class="font-semibold" style="min-width: 30px; text-align: center;">' + item.quantity + '</span><button class="tesla-icon-btn" onclick="updateCartQuantity(\'' + item.name + '\', ' + (item.quantity + 1) + ')"><span class="material-symbols-outlined">add</span></button></div><div style="text-align: right; margin-left: var(--spacing-md);"><p class="font-semibold">฿' + itemTotal + '</p><button onclick="removeFromCart(\'' + item.name + '\')" class="text-sm" style="color: var(--tesla-error); cursor: pointer; background: none; border: none; padding: 4px;">Remove</button></div></div></div>';
            });
            
            cartItemsContainer.innerHTML = cartHTML;
            const cartTotalElement = document.getElementById('cartTotal');
            if (cartTotalElement) {
                cartTotalElement.textContent = '฿' + total;
            }
        }
        
        function updateCheckoutDisplay() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const serviceCharge = Math.round(subtotal * 0.10);
            const tax = Math.round((subtotal + serviceCharge) * 0.07);
            const total = subtotal + serviceCharge + tax;
            
            const elements = {
                checkoutSubtotal: '฿' + subtotal,
                checkoutService: '฿' + serviceCharge,
                checkoutTax: '฿' + tax,
                checkoutTotal: '฿' + total
            };
            
            Object.keys(elements).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = elements[id];
                }
            });
        }
        
        // ===== ORDER FUNCTIONS =====
        function placeOrder() {
            if (cart.length === 0) {
                showToast('Your cart is empty');
                return;
            }
            
            const orderNumber = Math.floor(Math.random() * 10000);
            
            const order = {
                id: orderNumber,
                items: [...cart],
                status: 'preparing',
                orderTime: new Date(),
                estimatedDelivery: new Date(Date.now() + 20 * 60 * 1000),
                progress: 0
            };
            
            activeOrders.push(order);
            showToast('Order #' + orderNumber + ' placed successfully!');
            cart = [];
            updateCartBadge();
            
            simulateOrderProgress(order);
            showScreen('golferDashboard');
            
            setTimeout(function() {
                updateGolferDashboard();
            }, 500);
        }
        
        function simulateOrderProgress(order) {
            const interval = setInterval(function() {
                order.progress += Math.random() * 15;
                
                if (order.progress >= 100) {
                    order.status = 'delivered';
                    order.progress = 100;
                    clearInterval(interval);
                    showToast('Order #' + order.id + ' has been delivered!');
                    setTimeout(function() {
                        activeOrders = activeOrders.filter(function(o) { return o.id !== order.id; });
                        updateOrderTracking();
                        updateGolferDashboard();
                    }, 300000);
                } else if (order.progress >= 70) {
                    order.status = 'out_for_delivery';
                } else if (order.progress >= 40) {
                    order.status = 'cooking';
                }
                
                updateOrderTracking();
                updateGolferOrders();
            }, 3000);
        }
        
        function updateOrderTracking() {
            const activeOrdersContainer = document.getElementById('activeOrders');
            const noOrdersDiv = document.getElementById('noOrders');
            
            if (!activeOrdersContainer || !noOrdersDiv) return;
            
            if (activeOrders.length === 0) {
                activeOrdersContainer.innerHTML = '';
                noOrdersDiv.style.display = 'block';
                return;
            }
            
            noOrdersDiv.style.display = 'none';
            
            let ordersHTML = '';
            activeOrders.forEach(function(order) {
                ordersHTML += '<div class="tesla-card"><div class="flex justify-between items-center mb-md"><div><h4 class="font-semibold">Order #' + order.id + '</h4><p class="text-sm text-secondary">' + order.items.length + ' items • ' + getStatusText(order.status) + '</p></div><div style="text-align: right;"><div style="color: var(--tesla-primary); font-weight: 600;">' + Math.round(order.progress) + '%</div><div class="text-sm text-secondary">ETA: ' + getEstimatedTime(order.estimatedDelivery) + '</div></div></div><div class="mb-md"><div class="flex justify-between text-sm mb-sm"><span>Progress</span><span>' + Math.round(order.progress) + '%</span></div><div class="tesla-progress"><div class="tesla-progress-bar" style="width: ' + order.progress + '%"></div></div></div></div>';
            });
            
            activeOrdersContainer.innerHTML = ordersHTML;
        }
        
        function updateGolferOrders() {
            const golferOrdersContainer = document.getElementById('golferActiveOrders');
            if (!golferOrdersContainer) return;
            
            if (activeOrders.length === 0) {
                golferOrdersContainer.innerHTML = '<div class="text-center text-secondary" style="padding: var(--spacing-xl);"><span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: var(--spacing-sm);">receipt</span>No active orders</div>';
                return;
            }
            
            let ordersHTML = '';
            activeOrders.forEach(function(order) {
                ordersHTML += '<div class="tesla-list-item"><div class="flex justify-between items-center"><div style="flex: 1;"><h4 class="font-semibold mb-sm">Order #' + order.id + '</h4><p class="text-sm text-secondary">' + order.items.length + ' items • ' + getStatusText(order.status) + '</p></div><div style="text-align: right;"><div style="color: var(--tesla-primary); font-weight: 600;">' + Math.round(order.progress) + '%</div><div class="text-sm text-secondary">ETA: ' + getEstimatedTime(order.estimatedDelivery) + '</div></div></div><div class="mt-md"><div class="tesla-progress"><div class="tesla-progress-bar" style="width: ' + order.progress + '%"></div></div></div></div>';
            });
            
            golferOrdersContainer.innerHTML = ordersHTML;
        }
        
        function getStatusText(status) {
            switch(status) {
                case 'preparing': return 'Preparing';
                case 'cooking': return 'Cooking';
                case 'out_for_delivery': return 'Out for Delivery';
                case 'delivered': return 'Delivered';
                default: return 'Processing';
            }
        }
        
        function getEstimatedTime(estimatedDelivery) {
            const now = new Date();
            const diff = estimatedDelivery - now;
            if (diff <= 0) return 'Any moment';
            const minutes = Math.ceil(diff / 60000);
            return minutes + ' min';
        }
        
        function updateGolferDashboard() {
            updateGolferOrders();
            updatePlayerLocation();
        }
        
        function updatePlayerLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        playerLocation.lat = position.coords.latitude;
                        playerLocation.lng = position.coords.longitude;
                        updateLocationDisplay();
                    },
                    function() {
                        simulateMovement();
                        updateLocationDisplay();
                    }
                );
            } else {
                simulateMovement();
                updateLocationDisplay();
            }
        }
        
        function simulateMovement() {
            playerLocation.lat += (Math.random() - 0.5) * 0.0001;
            playerLocation.lng += (Math.random() - 0.5) * 0.0001;
        }
        
        function updateLocationDisplay() {
            const playerLatElement = document.getElementById('playerLat');
            const playerLngElement = document.getElementById('playerLng');
            const distanceToPinElement = document.getElementById('distanceToPin');
            
            if (playerLatElement) playerLatElement.textContent = playerLocation.lat.toFixed(4);
            if (playerLngElement) playerLngElement.textContent = playerLocation.lng.toFixed(4);
            
            const distanceToPin = Math.floor(Math.random() * 120) + 80;
            if (distanceToPinElement) distanceToPinElement.textContent = distanceToPin + ' yards';
        }
        
        function updateLocation() {
            updatePlayerLocation();
            showToast('GPS location updated!');
            
            if (Math.random() > 0.7) {
                currentHole = Math.min(18, currentHole + 1);
                const holeElement = document.getElementById('currentHole');
                if (holeElement) {
                    holeElement.textContent = currentHole;
                }
                showToast('Moved to Hole ' + currentHole + '!');
            }
        }
        
        // ===== BOOKING FUNCTIONS =====
        function bookCaddy() {
            showToast('Caddy booking request submitted');
        }
        
        function modifyBooking(bookingId) {
            showToast('Opening booking modification form');
        }
        
        function cancelBooking(bookingId) {
            showToast('Booking cancellation requested');
        }
        
        function registerEvent(eventId) {
            showToast('Event registration submitted');
        }
        
        // ===== CADDY BOOKING SYSTEM =====
        function openCaddyBooking(bookingId) {
            const booking = myBookings.find(b => b.id === bookingId);
            if (!booking) return;
            
            // Show booking info
            const bookingInfoDiv = document.getElementById('bookingInfo');
            bookingInfoDiv.innerHTML = `
                <div class="tesla-card p-0" style="padding: var(--spacing-md);">
                    <div class="flex items-center gap-md mb-sm">
                        <span class="material-symbols-outlined" style="color: var(--tesla-primary);">event</span>
                        <div style="flex: 1;">
                            <div class="font-semibold">${booking.date} at ${booking.time}</div>
                            <div class="text-sm text-secondary">${booking.course} • ${booking.holes} holes</div>
                            ${booking.bookingType === 'society' ? `<div class="text-sm" style="color: var(--tesla-primary);">${booking.societyName}</div>` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            // Store current booking context
            window.currentBookingContext = bookingId;
            
            // Populate caddy list
            renderCaddyList();
            
            // Show modal
            document.getElementById('caddyBookingModal').classList.add('active');
        }
        
        function closeCaddyBookingModal() {
            document.getElementById('caddyBookingModal').classList.remove('active');
            window.currentBookingContext = null;
        }
        
        function renderCaddyList(filter = 'all', searchTerm = '') {
            const container = document.getElementById('caddyListContainer');
            let filteredCaddies = [...caddyDatabase];
            
            // Apply availability filter
            if (filter === 'available') {
                filteredCaddies = filteredCaddies.filter(c => c.available);
            } else if (filter === 'booked') {
                filteredCaddies = filteredCaddies.filter(c => !c.available);
            }
            
            // Apply search filter
            if (searchTerm) {
                filteredCaddies = filteredCaddies.filter(c => 
                    c.name.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }
            
            container.innerHTML = filteredCaddies.map(caddy => `
                <div class="tesla-card">
                    <div class="flex gap-md mb-md">
                        <div style="width: 64px; height: 64px; border-radius: var(--radius-lg); background: linear-gradient(135deg, rgba(62,106,225,0.2), rgba(62,106,225,0.05)); display: flex; align-items: center; justify-content: center;">
                            <span class="material-symbols-outlined" style="font-size: 32px; color: var(--tesla-primary);">person</span>
                        </div>
                        <div style="flex: 1;">
                            <div class="flex justify-between items-start mb-sm">
                                <div>
                                    <h4 class="font-semibold" style="font-size: 18px;">${caddy.name}</h4>
                                    <div class="flex items-center gap-sm text-sm text-secondary">
                                        <span>⭐ ${caddy.rating}</span>
                                        <span>•</span>
                                        <span>${caddy.experience} years</span>
                                    </div>
                                </div>
                                <div style="padding: 4px 12px; background: ${caddy.available ? 'rgba(0,213,99,0.15)' : 'rgba(255,184,0,0.15)'}; color: ${caddy.available ? 'var(--tesla-success)' : 'var(--tesla-warning)'}; border-radius: var(--radius-full); font-size: 12px; font-weight: 600;">
                                    ${caddy.available ? 'AVAILABLE' : 'BOOKED'}
                                </div>
                            </div>
                            <div class="flex gap-sm mb-sm flex-wrap">
                                ${caddy.language.map(lang => `<span style="padding: 2px 8px; background: var(--tesla-surface); border-radius: var(--radius-sm); font-size: 11px;">${lang}</span>`).join('')}
                            </div>
                            <div class="text-sm text-secondary mb-md">
                                <span class="material-symbols-outlined" style="font-size: 16px; vertical-align: middle;">military_tech</span>
                                ${caddy.specialty}
                            </div>
                            ${!caddy.available ? `
                                <div class="text-sm mb-md" style="color: var(--tesla-warning); background: rgba(255,184,0,0.1); padding: 8px; border-radius: var(--radius-sm);">
                                    <div class="font-semibold mb-xs">Currently Booked:</div>
                                    ${caddy.bookings.map(b => `<div>• ${b.date} ${b.time} - ${b.golfer}</div>`).join('')}
                                    ${isOnWaitlist(caddy.id) ? '<div class="mt-sm" style="color: var(--tesla-primary);">✓ You are on the waitlist</div>' : ''}
                                </div>
                            ` : ''}
                            <div class="flex justify-between items-center">
                                <div>
                                    <div class="text-sm text-secondary">Price</div>
                                    <div class="font-semibold" style="font-size: 20px; color: var(--tesla-primary);">฿${caddy.price}</div>
                                </div>
                                <div class="flex gap-sm">
                                    ${caddy.available ? `
                                        <button class="tesla-btn tesla-btn-primary" onclick="bookCaddyNow(${caddy.id})">
                                            Book Now
                                        </button>
                                    ` : `
                                        ${isOnWaitlist(caddy.id) ? `
                                            <button class="tesla-btn tesla-btn-secondary" onclick="leaveWaitlist(${caddy.id})">
                                                Leave Waitlist
                                            </button>
                                        ` : `
                                            <button class="tesla-btn tesla-btn-secondary" onclick="joinWaitlist(${caddy.id})">
                                                Join Waitlist
                                            </button>
                                        `}
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function filterCaddies() {
            const searchTerm = document.getElementById('caddySearchInput').value;
            renderCaddyList('all', searchTerm);
        }
        
        function filterByAvailability(filter) {
            const searchTerm = document.getElementById('caddySearchInput').value;
            renderCaddyList(filter, searchTerm);
        }
        
        function bookCaddyNow(caddyId) {
            const caddy = caddyDatabase.find(c => c.id === caddyId);
            const booking = myBookings.find(b => b.id === window.currentBookingContext);
            
            if (!caddy || !booking) return;
            
            // Update booking with caddy
            booking.caddyId = caddyId;
            booking.caddyName = caddy.name;
            booking.status = 'confirmed';
            
            // Mark caddy as unavailable
            caddy.available = false;
            caddy.bookings.push({
                date: booking.date,
                time: booking.time,
                golfer: currentUser.name
            });
            
            closeCaddyBookingModal();
            updateMyBookingsList();
            
            // Show success notification
            showNotificationToast(`Success! ${caddy.name} has been booked for your tee time on ${booking.date} at ${booking.time}`);
        }
        
        function joinWaitlist(caddyId) {
            const caddy = caddyDatabase.find(c => c.id === caddyId);
            if (!caddy) return;
            
            // Initialize waitlist for this caddy if needed
            if (!waitlistQueue[caddyId]) {
                waitlistQueue[caddyId] = [];
            }
            
            // Add to waitlist
            waitlistQueue[caddyId].push({
                golferId: 'USER001',
                golferName: currentUser.name,
                notificationSent: false,
                timestamp: Date.now()
            });
            
            renderCaddyList();
            showNotificationToast(`You've joined the waitlist for ${caddy.name}. You're #${waitlistQueue[caddyId].length} in queue.`);
        }
        
        function leaveWaitlist(caddyId) {
            if (!waitlistQueue[caddyId]) return;
            
            // Remove from waitlist
            waitlistQueue[caddyId] = waitlistQueue[caddyId].filter(w => w.golferId !== 'USER001');
            
            renderCaddyList();
            showNotificationToast('You have left the waitlist');
        }
        
        function isOnWaitlist(caddyId) {
            if (!waitlistQueue[caddyId]) return false;
            return waitlistQueue[caddyId].some(w => w.golferId === 'USER001');
        }
        
        function cancelBookingWithCaddy(bookingId) {
            const booking = myBookings.find(b => b.id === bookingId);
            if (!booking || !booking.caddyId) return;
            
            const caddy = caddyDatabase.find(c => c.id === booking.caddyId);
            if (!caddy) return;
            
            // Show confirmation
            if (!confirm(`Are you sure you want to cancel your booking with ${caddy.name}? This will make the caddy available for others.`)) {
                return;
            }
            
            // Free up the caddy
            caddy.available = true;
            caddy.bookings = caddy.bookings.filter(b => b.golfer !== currentUser.name);
            
            // Clear booking caddy info
            const previousCaddyName = booking.caddyName;
            booking.caddyId = null;
            booking.caddyName = null;
            
            updateMyBookingsList();
            
            // Process waitlist
            if (waitlistQueue[caddy.id] && waitlistQueue[caddy.id].length > 0) {
                processWaitlistQueue(caddy.id);
            }
            
            showNotificationToast(`Your booking with ${previousCaddyName} has been cancelled`);
        }
        
        function processWaitlistQueue(caddyId) {
            const caddy = caddyDatabase.find(c => c.id === caddyId);
            if (!caddy || !waitlistQueue[caddyId] || waitlistQueue[caddyId].length === 0) return;
            
            // Get first person in queue
            const nextInQueue = waitlistQueue[caddyId][0];
            
            // Check if it's current user
            if (nextInQueue.golferId === 'USER001') {
                // Show offer to current user
                showCaddyOffer(caddy, nextInQueue);
            } else {
                // In real system, this would send notification to that user
                console.log(`Offer sent to ${nextInQueue.golferName}`);
            }
        }
        
        function showCaddyOffer(caddy, queueEntry) {
            const booking = myBookings.find(b => !b.caddyId); // Find first booking without caddy
            if (!booking) return;
            
            // Store offer context
            window.currentOffer = {
                caddyId: caddy.id,
                caddyName: caddy.name,
                bookingId: booking.id,
                queueEntry: queueEntry,
                timeRemaining: 600 // 10 minutes in seconds
            };
            
            // Update modal content
            document.getElementById('offerCaddyName').textContent = caddy.name;
            document.getElementById('offerDetails').textContent = 
                `Your preferred caddy is now available for your tee time on ${booking.date} at ${booking.time}`;
            
            // Show modal
            document.getElementById('caddyOfferModal').classList.add('active');
            
            // Start countdown
            startOfferCountdown();
        }
        
        function startOfferCountdown() {
            if (offerTimeout) {
                clearInterval(offerTimeout);
            }
            
            offerTimeout = setInterval(() => {
                if (!window.currentOffer) {
                    clearInterval(offerTimeout);
                    return;
                }
                
                window.currentOffer.timeRemaining--;
                
                const minutes = Math.floor(window.currentOffer.timeRemaining / 60);
                const seconds = window.currentOffer.timeRemaining % 60;
                
                document.getElementById('offerCountdown').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (window.currentOffer.timeRemaining <= 0) {
                    // Time expired, auto-decline
                    declineOffer();
                }
            }, 1000);
        }
        
        function acceptOffer() {
            if (!window.currentOffer) return;
            
            const caddy = caddyDatabase.find(c => c.id === window.currentOffer.caddyId);
            const booking = myBookings.find(b => b.id === window.currentOffer.bookingId);
            
            if (!caddy || !booking) return;
            
            // Book the caddy
            booking.caddyId = caddy.id;
            booking.caddyName = caddy.name;
            booking.status = 'confirmed';
            
            caddy.available = false;
            caddy.bookings.push({
                date: booking.date,
                time: booking.time,
                golfer: currentUser.name
            });
            
            // Remove from waitlist
            waitlistQueue[caddy.id] = waitlistQueue[caddy.id].filter(w => w.golferId !== 'USER001');
            
            // Close modal
            document.getElementById('caddyOfferModal').classList.remove('active');
            clearInterval(offerTimeout);
            window.currentOffer = null;
            
            updateMyBookingsList();
            updatePendingOffersList();
            
            showNotificationToast(`Success! ${caddy.name} has been booked for ${booking.date} at ${booking.time}`);
        }
        
        function declineOffer() {
            if (!window.currentOffer) return;
            
            const caddyId = window.currentOffer.caddyId;
            
            // Remove from waitlist
            if (waitlistQueue[caddyId]) {
                waitlistQueue[caddyId] = waitlistQueue[caddyId].filter(w => w.golferId !== 'USER001');
                
                // Process next in queue
                if (waitlistQueue[caddyId].length > 0) {
                    const nextInQueue = waitlistQueue[caddyId][0];
                    console.log(`Offer moving to next in queue: ${nextInQueue.golferName}`);
                }
            }
            
            // Close modal
            document.getElementById('caddyOfferModal').classList.remove('active');
            clearInterval(offerTimeout);
            window.currentOffer = null;
            
            updatePendingOffersList();
            
            showNotificationToast('Offer declined. Moving to next person in queue.');
        }
        
        function updateMyBookingsList() {
            const container = document.getElementById('myBookingsList');
            if (!container) return;
            
            container.innerHTML = myBookings.map(booking => `
                <div class="tesla-card">
                    <div class="flex justify-between items-start mb-md">
                        <div class="flex items-center gap-md" style="flex: 1;">
                            <div style="width: 56px; height: 56px; border-radius: var(--radius-md); background: rgba(0,213,99,0.15); display: flex; align-items: center; justify-content: center;">
                                <span class="material-symbols-outlined" style="color: var(--tesla-success); font-size: 28px;">golf_course</span>
                            </div>
                            <div style="flex: 1;">
                                <h4 class="font-semibold mb-sm" style="font-size: 18px;">${booking.type === 'tee_time' ? 'Tee Time' : 'Practice Session'}</h4>
                                <p class="text-sm text-secondary mb-xs">${booking.date} at ${booking.time} • ${booking.course}</p>
                                <p class="text-sm text-secondary mb-xs">${booking.holes} holes • ${booking.players} player(s)</p>
                                ${booking.bookingType === 'society' ? `<p class="text-sm" style="color: var(--tesla-primary);">${booking.societyName}</p>` : `<p class="text-sm text-secondary">Private Booking</p>`}
                                ${booking.caddyName ? `
                                    <div class="flex items-center gap-sm mt-sm">
                                        <span class="material-symbols-outlined" style="font-size: 16px; color: var(--tesla-primary);">person</span>
                                        <span class="text-sm font-semibold" style="color: var(--tesla-primary);">Caddy: ${booking.caddyName}</span>
                                    </div>
                                ` : `
                                    <div class="flex items-center gap-sm mt-sm">
                                        <span class="material-symbols-outlined" style="font-size: 16px; color: var(--tesla-warning);">warning</span>
                                        <span class="text-sm" style="color: var(--tesla-warning);">No caddy booked</span>
                                    </div>
                                `}
                            </div>
                        </div>
                        <span style="padding: 6px 14px; background: rgba(0,213,99,0.15); color: var(--tesla-success); border-radius: var(--radius-full); font-size: 12px; font-weight: 600; text-transform: uppercase;">
                            ${booking.status}
                        </span>
                    </div>
                    <div class="flex gap-sm">
                        ${booking.caddyName ? `
                            <button class="tesla-btn tesla-btn-secondary" style="flex: 1;" onclick="cancelBookingWithCaddy('${booking.id}')">
                                <span class="material-symbols-outlined" style="font-size: 18px;">close</span>
                                Cancel Caddy
                            </button>
                        ` : `
                            <button class="tesla-btn tesla-btn-primary" style="flex: 1;" onclick="openCaddyBooking('${booking.id}')">
                                <span class="material-symbols-outlined" style="font-size: 18px;">person_add</span>
                                Book Caddy
                            </button>
                        `}
                        <button class="tesla-btn tesla-btn-ghost" style="flex: 1;" onclick="viewBookingDetails('${booking.id}')">
                            <span class="material-symbols-outlined" style="font-size: 18px;">info</span>
                            Details
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function updatePendingOffersList() {
            const container = document.getElementById('pendingOffersList');
            if (!container) return;
            
            // Check if user has any active offers
            const hasActiveOffer = window.currentOffer !== null;
            
            if (!hasActiveOffer) {
                container.innerHTML = `
                    <div class="text-center text-secondary py-xl">
                        <span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: var(--spacing-sm);">notifications</span>
                        No pending offers
                    </div>
                `;
            }
        }
        
        
        // ===== CADDIE FUNCTIONS =====
        function showCaddieTab(tabName) {
            const tabs = document.querySelectorAll('#caddieDashboard .tesla-nav-item');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const activeTab = Array.from(tabs).find(tab => tab.textContent.toLowerCase().includes(tabName));
            if (activeTab) activeTab.classList.add('active');
            
            const tabContents = document.querySelectorAll('#caddieDashboard .tab-content');
            tabContents.forEach(content => content.classList.add('hidden'));
            
            const targetContent = document.getElementById('caddie' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab');
            if (targetContent) targetContent.classList.remove('hidden');
            
            if (tabName === 'assignments') {
                updateCaddieAssignments();
            } else if (tabName === 'communication') {
                updateMessagesList();
            } else if (tabName === 'schedule') {
                updateCaddieSchedule();
            }
        }
        
        function updateCaddieAssignments() {
            const assignmentDiv = document.getElementById('currentAssignment');
            if (!assignmentDiv) return;
            
            if (caddieCurrentAssignment) {
                assignmentDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-lg">
                        <div style="flex: 1;">
                            <h3 class="font-semibold mb-sm" style="font-size: 22px;">${caddieCurrentAssignment.golferName}</h3>
                            <p class="text-secondary mb-sm">Started at ${caddieCurrentAssignment.startTime} • ${caddieCurrentAssignment.holes} holes</p>
                            <div class="flex items-center gap-sm">
                                <span class="material-symbols-outlined" style="font-size: 20px; color: var(--tesla-primary);">golf_course</span>
                                <span style="color: var(--tesla-primary); font-weight: 600;">Currently on Hole ${caddieCurrentAssignment.currentHole}</span>
                            </div>
                        </div>
                        <span style="padding: 6px 14px; background: rgba(0,213,99,0.15); color: var(--tesla-success); border-radius: var(--radius-full); font-size: 12px; font-weight: 600; text-transform: uppercase;">
                            ${caddieCurrentAssignment.status.replace('_', ' ')}
                        </span>
                    </div>
                    <div class="flex gap-sm">
                        <button class="tesla-btn tesla-btn-primary" style="flex: 1;" onclick="toggleRoundGPS()">
                            <span class="material-symbols-outlined">my_location</span>
                            ${caddieGPSTracking ? 'End Round' : 'Start Round'}
                        </button>
                        <button class="tesla-btn tesla-btn-secondary" style="flex: 1;" onclick="showScreen('caddieLocationScreen')">
                            <span class="material-symbols-outlined">location_on</span>
                            View Location
                        </button>
                    </div>
                `;
            } else {
                assignmentDiv.innerHTML = `
                    <div class="text-center py-xl">
                        <span class="material-symbols-outlined" style="font-size: 64px; opacity: 0.3; display: block; margin-bottom: var(--spacing-md);">event_busy</span>
                        <h3 class="font-semibold mb-sm">No Current Assignment</h3>
                        <p class="text-secondary">You'll be notified when assigned to a golfer</p>
                    </div>
                `;
            }
            
            updateActiveReports();
            updateTodaySchedule();
        }
        
        function updateActiveReports() {
            const reportsDiv = document.getElementById('activeReports');
            if (!reportsDiv) return;
            
            if (caddieReports.length === 0) {
                reportsDiv.innerHTML = `
                    <div class="text-center text-secondary py-xl">
                        <span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: var(--spacing-sm);">check_circle</span>
                        No active reports
                    </div>
                `;
                return;
            }
            
            reportsDiv.innerHTML = caddieReports.map(report => `
                <div class="tesla-card">
                    <div class="flex justify-between items-start mb-md">
                        <div style="flex: 1;">
                            <h4 class="font-semibold mb-sm">${report.type.replace(/_/g, ' ').toUpperCase()}</h4>
                            <p class="text-sm text-secondary mb-xs">Hole ${report.hole} • ${report.time}</p>
                            <p class="text-sm">${report.comments}</p>
                        </div>
                        <span style="padding: 4px 12px; background: rgba(255,184,0,0.15); color: var(--tesla-warning); border-radius: var(--radius-full); font-size: 12px; font-weight: 600;">
                            ${report.status}
                        </span>
                    </div>
                    <div class="tesla-progress">
                        <div class="tesla-progress-bar" style="width: ${report.progress}%"></div>
                    </div>
                </div>
            `).join('');
        }
        
        function updateTodaySchedule() {
            const scheduleDiv = document.getElementById('todaySchedule');
            if (!scheduleDiv) return;
            
            const todayRounds = caddieSchedule.filter(s => s.status !== 'completed').slice(0, 3);
            
            scheduleDiv.innerHTML = todayRounds.map(round => `
                <div class="tesla-card">
                    <div class="flex justify-between items-center">
                        <div style="flex: 1;">
                            <h4 class="font-semibold mb-sm">${round.time} - ${round.golfer}</h4>
                            <p class="text-sm text-secondary">${round.holes} holes</p>
                        </div>
                        <span style="padding: 4px 12px; background: ${round.status === 'in_progress' ? 'rgba(62,106,225,0.15)' : 'rgba(255,255,255,0.05)'}; color: ${round.status === 'in_progress' ? 'var(--tesla-primary)' : 'var(--tesla-text-secondary)'}; border-radius: var(--radius-full); font-size: 12px; font-weight: 600;">
                            ${round.status.replace('_', ' ')}
                        </span>
                    </div>
                </div>
            `).join('');
        }
        
        function toggleRoundGPS() {
            caddieGPSTracking = !caddieGPSTracking;
            if (caddieGPSTracking) {
                showNotificationToast('GPS tracking started for current round');
            } else {
                showNotificationToast('Round ended. GPS tracking stopped.');
                caddieCurrentAssignment.status = 'completed';
            }
            updateCaddieAssignments();
        }
        
        function reportIssue() {
            document.getElementById('reportIssueModal').classList.add('active');
        }
        
        function closeReportIssueModal() {
            document.getElementById('reportIssueModal').classList.remove('active');
        }
        
        function submitIssueReport() {
            const type = document.getElementById('issueType').value;
            const hole = document.getElementById('issueHole').value;
            const comments = document.getElementById('issueComments').value;
            
            if (!comments.trim()) {
                showNotificationToast('Please provide details about the issue');
                return;
            }
            
            const report = {
                id: Date.now(),
                type: type,
                hole: hole,
                comments: comments,
                time: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }),
                status: 'pending',
                progress: 0
            };
            
            caddieReports.push(report);
            
            closeReportIssueModal();
            showNotificationToast('Issue reported successfully');
            updateActiveReports();
            
            // Simulate report progress
            simulateReportProgress(report);
            
            // Clear form
            document.getElementById('issueComments').value = '';
        }
        
        function simulateReportProgress(report) {
            const interval = setInterval(() => {
                report.progress += Math.random() * 20;
                
                if (report.progress >= 100) {
                    report.progress = 100;
                    report.status = 'resolved';
                    clearInterval(interval);
                    showNotificationToast('Issue #' + report.id + ' has been resolved');
                } else if (report.progress >= 50) {
                    report.status = 'in_progress';
                }
                
                updateActiveReports();
            }, 5000);
        }
        
        function requestBreak() {
            showNotificationToast('Break request sent to Caddy Master');
        }
        
        function openChat(recipient) {
            showNotificationToast('Opening chat with ' + recipient.replace('_', ' '));
            showCaddieTab('communication');
        }
        
        function updateMessagesList() {
            const messagesDiv = document.getElementById('messagesList');
            if (!messagesDiv) return;
            
            if (caddieMessages.length === 0) {
                messagesDiv.innerHTML = `
                    <div class="text-center text-secondary py-xl">
                        <span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: var(--spacing-sm);">mail</span>
                        No messages
                    </div>
                `;
                return;
            }
            
            messagesDiv.innerHTML = caddieMessages.map(msg => `
                <div class="tesla-card ${msg.read ? '' : 'border-2'}" style="${msg.read ? '' : 'border-color: var(--tesla-primary);'}">
                    <div class="flex justify-between items-start mb-sm">
                        <h4 class="font-semibold">${msg.from}</h4>
                        <span class="text-sm text-secondary">${msg.time}</span>
                    </div>
                    <p class="text-secondary">${msg.message}</p>
                </div>
            `).join('');
        }
        
        function sendMessage() {
            const recipient = document.getElementById('messageRecipient').value;
            const content = document.getElementById('messageContent').value;
            
            if (!content.trim()) {
                showNotificationToast('Please enter a message');
                return;
            }
            
            showNotificationToast('Message sent to ' + recipient.replace('_', ' '));
            document.getElementById('messageContent').value = '';
        }
        
        function updateCaddieSchedule() {
            const scheduleDiv = document.getElementById('fullSchedule');
            if (!scheduleDiv) return;
            
            scheduleDiv.innerHTML = caddieSchedule.map(round => `
                <div class="tesla-card">
                    <div class="flex justify-between items-start mb-md">
                        <div style="flex: 1;">
                            <div class="flex items-center gap-sm mb-sm">
                                <span style="font-size: 20px; font-weight: 700; color: var(--tesla-primary);">${round.time}</span>
                                <span style="padding: 4px 12px; background: ${
                                    round.status === 'completed' ? 'rgba(0,213,99,0.15)' : 
                                    round.status === 'in_progress' ? 'rgba(62,106,225,0.15)' : 
                                    'rgba(255,255,255,0.05)'
                                }; color: ${
                                    round.status === 'completed' ? 'var(--tesla-success)' : 
                                    round.status === 'in_progress' ? 'var(--tesla-primary)' : 
                                    'var(--tesla-text-secondary)'
                                }; border-radius: var(--radius-full); font-size: 11px; font-weight: 600; text-transform: uppercase;">
                                    ${round.status.replace('_', ' ')}
                                </span>
                            </div>
                            <h4 class="font-semibold mb-xs">${round.golfer}</h4>
                            <p class="text-sm text-secondary">${round.holes} holes</p>
                        </div>
                        ${round.tip > 0 ? `
                            <div class="text-center">
                                <div class="text-sm text-secondary mb-xs">Tip</div>
                                <div style="font-size: 20px; font-weight: 700; color: var(--tesla-success);">฿${round.tip}</div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }
        
        function toggleGPSTracking(enabled) {
            caddieGPSTracking = enabled;
            const statusDiv = document.getElementById('gpsStatus');
            
            if (enabled) {
                statusDiv.innerHTML = 'GPS tracking is currently ON';
                statusDiv.style.background = 'rgba(0,213,99,0.1)';
                statusDiv.style.color = 'var(--tesla-success)';
                showNotificationToast('GPS tracking enabled');
            } else {
                statusDiv.innerHTML = 'GPS tracking is currently OFF';
                statusDiv.style.background = 'rgba(255,184,0,0.1)';
                statusDiv.style.color = 'var(--tesla-warning)';
                showNotificationToast('GPS tracking disabled');
            }
        }
        
        
        // ===== MANAGER FUNCTIONS =====
        function showManagerTab(tabName) {
            const tabs = document.querySelectorAll('#managerDashboard .tesla-nav-item');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const activeTab = Array.from(tabs).find(tab => tab.textContent.toLowerCase().includes(tabName));
            if (activeTab) activeTab.classList.add('active');
            
            const tabContents = document.querySelectorAll('#managerDashboard .tab-content');
            tabContents.forEach(content => content.classList.add('hidden'));
            
            const targetContent = document.getElementById('manager' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab');
            if (targetContent) targetContent.classList.remove('hidden');
            
            if (tabName === 'overview') {
                updateManagerOverview();
            } else if (tabName === 'staff') {
                updateStaffList();
            } else if (tabName === 'alerts') {
                updateAllAlerts();
            }
        }
        
        function updateManagerOverview() {
            const alertsList = document.getElementById('managerAlertsList');
            if (!alertsList) return;
            
            alertsList.innerHTML = managerAlerts.slice(0, 3).map(alert => `
                <div class="tesla-card">
                    <div class="flex justify-between items-start mb-sm">
                        <div style="flex: 1;">
                            <div class="flex items-center gap-sm mb-sm">
                                <span class="material-symbols-outlined" style="font-size: 20px; color: ${
                                    alert.severity === 'high' ? 'var(--tesla-error)' : 
                                    alert.severity === 'medium' ? 'var(--tesla-warning)' : 
                                    'var(--tesla-text-secondary)'
                                };">${
                                    alert.type === 'medical' ? 'emergency' : 
                                    alert.type === 'weather' ? 'cloud' : 'build'
                                }</span>
                                <span style="padding: 2px 8px; background: ${
                                    alert.severity === 'high' ? 'rgba(255,68,68,0.15)' : 
                                    alert.severity === 'medium' ? 'rgba(255,184,0,0.15)' : 
                                    'rgba(255,255,255,0.05)'
                                }; color: ${
                                    alert.severity === 'high' ? 'var(--tesla-error)' : 
                                    alert.severity === 'medium' ? 'var(--tesla-warning)' : 
                                    'var(--tesla-text-secondary)'
                                }; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600; text-transform: uppercase;">
                                    ${alert.severity}
                                </span>
                            </div>
                            <h4 class="font-semibold mb-xs">${alert.message}</h4>
                            <p class="text-sm text-secondary">${alert.time}</p>
                        </div>
                        <button class="tesla-btn tesla-btn-secondary" style="padding: 8px 16px; font-size: 13px;" onclick="resolveAlert(${alert.id})">
                            ${alert.status === 'active' ? 'Resolve' : 'View'}
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function updateStaffList() {
            const caddieList = document.getElementById('caddieStaffList');
            if (!caddieList) return;
            
            caddieList.innerHTML = managerStaff.caddies.map(caddy => `
                <div class="tesla-card">
                    <div class="flex justify-between items-center">
                        <div style="flex: 1;">
                            <div class="flex items-center gap-sm mb-sm">
                                <h4 class="font-semibold">${caddy.name}</h4>
                                <span style="padding: 2px 8px; background: ${
                                    caddy.status === 'active' ? 'rgba(0,213,99,0.15)' : 
                                    caddy.status === 'break' ? 'rgba(255,184,0,0.15)' : 
                                    'rgba(255,255,255,0.05)'
                                }; color: ${
                                    caddy.status === 'active' ? 'var(--tesla-success)' : 
                                    caddy.status === 'break' ? 'var(--tesla-warning)' : 
                                    'var(--tesla-text-secondary)'
                                }; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600; text-transform: uppercase;">
                                    ${caddy.status}
                                </span>
                                <span class="text-sm">⭐ ${caddy.rating}</span>
                            </div>
                            ${caddy.golfer ? `
                                <p class="text-sm text-secondary">With: ${caddy.golfer} • Hole ${caddy.currentHole}</p>
                            ` : `
                                <p class="text-sm text-secondary">${caddy.status === 'break' ? 'On break' : 'Available for assignment'}</p>
                            `}
                        </div>
                        <div class="flex gap-sm">
                            <button class="tesla-icon-btn" onclick="contactStaff(${caddy.id})">
                                <span class="material-symbols-outlined">message</span>
                            </button>
                            <button class="tesla-icon-btn" onclick="viewStaffDetails(${caddy.id})">
                                <span class="material-symbols-outlined">info</span>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function updateAllAlerts() {
            const alertsList = document.getElementById('allAlertsList');
            if (!alertsList) return;
            
            alertsList.innerHTML = managerAlerts.map(alert => `
                <div class="tesla-card">
                    <div class="flex justify-between items-start">
                        <div style="flex: 1;">
                            <div class="flex items-center gap-sm mb-sm">
                                <span class="material-symbols-outlined" style="font-size: 20px; color: ${
                                    alert.severity === 'high' ? 'var(--tesla-error)' : 
                                    alert.severity === 'medium' ? 'var(--tesla-warning)' : 
                                    'var(--tesla-text-secondary)'
                                };">${
                                    alert.type === 'medical' ? 'emergency' : 
                                    alert.type === 'weather' ? 'cloud' : 'build'
                                }</span>
                                <span style="padding: 2px 8px; background: ${
                                    alert.severity === 'high' ? 'rgba(255,68,68,0.15)' : 
                                    alert.severity === 'medium' ? 'rgba(255,184,0,0.15)' : 
                                    'rgba(255,255,255,0.05)'
                                }; color: ${
                                    alert.severity === 'high' ? 'var(--tesla-error)' : 
                                    alert.severity === 'medium' ? 'var(--tesla-warning)' : 
                                    'var(--tesla-text-secondary)'
                                }; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600; text-transform: uppercase;">
                                    ${alert.severity}
                                </span>
                            </div>
                            <h4 class="font-semibold mb-xs">${alert.message}</h4>
                            <p class="text-sm text-secondary">${alert.time}</p>
                        </div>
                        <button class="tesla-btn tesla-btn-primary" style="padding: 8px 16px; font-size: 13px;" onclick="resolveAlert(${alert.id})">
                            ${alert.status === 'active' ? 'Resolve' : 'Resolved'}
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function resolveAlert(alertId) {
            const alert = managerAlerts.find(a => a.id === alertId);
            if (alert) {
                alert.status = 'resolved';
                showNotificationToast('Alert #' + alertId + ' resolved');
                updateManagerOverview();
                updateAllAlerts();
            }
        }
        
        function contactStaff(staffId) {
            showNotificationToast('Opening chat with staff member');
        }
        
        function viewStaffDetails(staffId) {
            showNotificationToast('Viewing staff details');
        }
        
        function openCourseReportModal() {
            document.getElementById('courseReportModal').classList.add('active');
        }
        
        function closeCourseReportModal() {
            document.getElementById('courseReportModal').classList.remove('active');
        }
        
        function submitCourseReport() {
            const category = document.getElementById('reportCategory').value;
            const hole = document.getElementById('reportHole').value;
            const condition = document.getElementById('reportCondition').value;
            const notes = document.getElementById('reportNotes').value;
            
            showNotificationToast('Course report submitted for Hole ' + hole);
            closeCourseReportModal();
            
            document.getElementById('reportNotes').value = '';
        }
        
        function showNotificationToast(message) {
            // Create proper notification toast
            const toast = document.createElement('div');
            toast.className = 'tesla-toast show';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }
        
        // ===== UI FUNCTIONS =====
        function showToast(message) {
            // Toast notifications disabled - they were annoying
            console.log('Notification:', message);
        }
        
        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize LINE LIFF
            initializeLiff();
            
            // Load saved language
            const savedLanguage = localStorage.getItem('preferredLanguage');
            if (savedLanguage && translations[savedLanguage]) {
                currentLanguage = savedLanguage;
                const selectors = ['languageSelect', 'golferLanguage'];
                selectors.forEach(id => {
                    const selector = document.getElementById(id);
                    if (selector) {
                        selector.value = savedLanguage;
                    }
                });
            }
            
            updateCartBadge();
            updateAllText();
            updateMyBookingsList();
            updatePendingOffersList();
        });
    </script>
</body>
</html>